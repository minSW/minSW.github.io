<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> &#039;Spark The Definitive Guide&#039; 3ì¥ - ì¼ë‹¨ ì¢€ ë” ì¡ì†¨ë´ (PART 1 ë) Â· Look out</title><meta name="description" content="&amp;#039;Spark The Definitive Guide&amp;#039; 3ì¥ - ì¼ë‹¨ ì¢€ ë” ì¡ì†¨ë´ (PART 1 ë) - Lukka Min"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/cover.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="search" type="application/opensearchdescription+xml" href="https://minsw.github.io/atom.xml" title="Look out"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/feed.xml" title="Look out" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/cover.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/tags/" target="_self">TAG</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/minSW" target="_blank">GITHUB</a></li></ul></header><main class="container"></main><div class="post"><article class="post-block"><h1 class="post-title">&#039;Spark The Definitive Guide&#039; 3ì¥ - ì¼ë‹¨ ì¢€ ë” ì¡ì†¨ë´ (PART 1 ë)</h1><div class="post-info">2021ë…„ 1ì›” 24ì¼<span class="categories"><i class="fa fa-bookmark" aria-hidden="true"></i></span><a class="post-category" href="/categories/spark/">#spark</a></div><div class="post-content"><br/>

<h4 id="Part-1-END"><a href="#Part-1-END" class="headerlink" title="[Part 1] END"></a>[Part 1] END</h4><p>íŒŒíŠ¸ 1 ê¹Œì§€ ëë‚´ê³  ë‚˜ë‹ˆ ì´ì œ ì¡°ê¸ˆì”© ìŠ¤íŒŒí¬ ë§›ì€ ë³¸ ê²ƒ ê°™ì€ë°, ì´ë²ˆ ì¥ì€ ë”°ë¼ê°€ê¸° ì‚´ì§ í˜ë“¤ì—ˆë‹¤.</p>
<blockquote>
<p>ë‚˜ : ë­” ë§ì´ì—ìš”<br>?? : <em>â€˜XX ì¥ì—ì„œ ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.â€™</em></p>
<p>ë‚˜ : ì´ê±´ ë˜ ë­ì—¬<br>?? : <em>â€˜ì´ì™€ ê´€ë ¨ëœ ë‚´ìš©ì€ XX ë¶€ì—ì„œ ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.â€™</em></p>
</blockquote>
<p><img width="150" alt="angry" src="https://user-images.githubusercontent.com/26691216/105637781-85fbe680-5eb2-11eb-8956-b7de17f122de.png
"></p>
<center><i style="color:lightgray">ì´toRLë“¤ì´..</i></center>



<p>ì˜¤ëŠ˜ì€ ì˜ˆì œ ìœ„ì£¼ë¡œ ëª¨ë¥´ëŠ” ë¶€ë¶„ ì°¾ì•„ê°€ë©´ì„œ ì–´ì°Œ ì €ì°Œ ì´í•´ëŠ” í–ˆì§€ë§Œ<br>ê·¸ ë‹¤ìŒ íŒŒíŠ¸ëŠ” ë‹¤ì‹œ ë˜ <code>êµ¬ì¡°ì  API</code>ë¼ ì˜¤ëŠ˜ ë³¸ ê±° ëŒ€ë¶€ë¶„ì€ í•œì°¸ ë’¤ì—ì•¼ ë‹¤ì‹œ ë³´ê²Œ ë í…ë°..<br>ì•„ ì´ê±° ë¬´ì¡°ê±´ì¸ë°.. ë°±í¼ ë‹¤ ê¹Œë¨¹ëŠ”ë°.. ğŸ¤¦ğŸ»â€â™€ï¸  </p>
<center><h2>_ _ _</h2></center>

<br/>

<hr>
<h1 id="CHAPTER-3-ìŠ¤íŒŒí¬-ê¸°ëŠ¥-ë‘˜ëŸ¬ë³´ê¸°"><a href="#CHAPTER-3-ìŠ¤íŒŒí¬-ê¸°ëŠ¥-ë‘˜ëŸ¬ë³´ê¸°" class="headerlink" title="CHAPTER 3 ìŠ¤íŒŒí¬ ê¸°ëŠ¥ ë‘˜ëŸ¬ë³´ê¸°"></a>CHAPTER 3 ìŠ¤íŒŒí¬ ê¸°ëŠ¥ ë‘˜ëŸ¬ë³´ê¸°</h1><blockquote>
<p>ìŠ¤íŒŒí¬ = ê¸°ë³¸ ìš”ì†Œ (ì €ìˆ˜ì¤€ API + êµ¬ì¡°ì  API) + ì¶”ê°€ ê¸°ëŠ¥ (ì¼ë ¨ì˜ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬)</p>
<ul>
<li>êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°, ê³ ê¸‰ ë¶„ì„, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì—ì½”ì‹œìŠ¤í…œ</li>
<li>êµ¬ì¡°ì  API : Dataset, DataFrame, SQL</li>
<li>ì €ìˆ˜ì¤€ API : RDD, ë¶„ì‚°í˜• ë³€ìˆ˜</li>
</ul>
</blockquote>
<p>CHAPTER 2 ëŠ” êµ¬ì¡°ì  APIì˜ í•µì‹¬ê°œë…ì„ ì†Œê°œí–ˆë‹¤ë©´<br>CHAPTER 3 ì€ ë‚˜ë¨¸ì§€ API ì™€ ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬, ìŠ¤íŒŒí¬ì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ ì†Œê°œ</p>
<h3 id="3-1-ìš´ì˜ìš©-ì• í”Œë¦¬ì¼€ì´ì…˜-ì‹¤í–‰í•˜ê¸°"><a href="#3-1-ìš´ì˜ìš©-ì• í”Œë¦¬ì¼€ì´ì…˜-ì‹¤í–‰í•˜ê¸°" class="headerlink" title="3.1 ìš´ì˜ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰í•˜ê¸°"></a>3.1 ìš´ì˜ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰í•˜ê¸°</h3><details><summary class="point-color-can-hover">[3.1] ì˜ˆì œ í¼ì¹˜ê¸°</summary>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /spark-2.4.7-bin-hadoop2.7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># scalar example</span></span><br><span class="line">$ ./bin/spark-submit --class org.apache.spark.examples.SparkPi --master <span class="built_in">local</span> ./examples/jars/spark-examples_2.11-2.4.7.jar 10</span><br><span class="line">...</span><br><span class="line">21/01/24 13:41:15 INFO DAGScheduler: Job 0 finished: reduce at SparkPi.scala:38, took 0.968079 s</span><br><span class="line">Pi is roughly 3.1414071414071416 <span class="comment"># ëŒë¦´ë•Œë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë‚˜ì˜¨ë‹¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python example</span></span><br><span class="line">$ ./bin/spark-submit --master <span class="built_in">local</span> ./examples/src/main/python/pi.py 10</span><br><span class="line">Pi is roughly 3.139084 <span class="comment"># ì´ëŸ´ê±°ë©´ args ëŠ” ëŒ€ì²´ ì™œ ë„£ìœ¼ë€ê±¸ê¹Œ</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>spark-submit</code> ëª…ë ¹<ul>
<li>ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œë¥¼ í´ëŸ¬ìŠ¤í„°ì— ì „ì†¡í•´ ì‹¤í–‰ì‹œí‚¤ëŠ” ì—­í• </li>
<li>ëŒ€í™”í˜• ì‰˜ì—ì„œ ê°œë°œí•œ í”„ë¡œê·¸ë¨ -&gt; ìš´ì˜ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ì „í™˜ ê°€ëŠ¥</li>
<li>ìŠ¤íŒŒí¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ standalone, Mesos, YARN í´ëŸ¬ìŠ¤í„° ë§¤ë‹ˆì €ë¥¼ ì´ìš©í•´ ì‹¤í–‰ë¨ (<code>--master</code> ì˜µì…˜)</li>
</ul>
</li>
</ul>
<h3 id="3-2-Dataset-íƒ€ì…-ì•ˆì •ì„±ì„-ì œê³µí•˜ëŠ”-êµ¬ì¡°ì -API"><a href="#3-2-Dataset-íƒ€ì…-ì•ˆì •ì„±ì„-ì œê³µí•˜ëŠ”-êµ¬ì¡°ì -API" class="headerlink" title="3.2 Dataset : íƒ€ì… ì•ˆì •ì„±ì„ ì œê³µí•˜ëŠ” êµ¬ì¡°ì  API"></a>3.2 Dataset : íƒ€ì… ì•ˆì •ì„±ì„ ì œê³µí•˜ëŠ” êµ¬ì¡°ì  API</h3><details><summary class="point-color-can-hover">[3.2] ì˜ˆì œ í¼ì¹˜ê¸°</summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Flight</span>(<span class="params"><span class="type">DEST_COUNTRY_NAME</span>: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">                  <span class="type">ORIGIN_COUNTRY_NAME</span>: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">                  count: <span class="type">BigInt</span></span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">val</span> <span class="title">flightsDF</span> </span>= spark.read.parquet(<span class="string">&quot;/data/flight-data/parquet/2010-summary.parquet/&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> flights = flightsDF.as[<span class="type">Flight</span>] <span class="comment">// DataFrame -&gt; Dataset[Flight]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(flights</span><br><span class="line">  .filter(flight_row =&gt; flight_row.<span class="type">ORIGIN_COUNTRY_NAME</span> != <span class="string">&quot;Canada&quot;</span>)</span><br><span class="line">  .map(flight_row =&gt; flight_row)</span><br><span class="line">  .take(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">(flights</span><br><span class="line">  .take(<span class="number">5</span>)</span><br><span class="line">  .filter(flight_row =&gt; flight_row.<span class="type">ORIGIN_COUNTRY_NAME</span> != <span class="string">&quot;Canada&quot;</span>)</span><br><span class="line">  .map(fr =&gt; <span class="type">Flight</span>(fr.<span class="type">DEST_COUNTRY_NAME</span>, fr.<span class="type">ORIGIN_COUNTRY_NAME</span>, fr.count + <span class="number">5</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// res45: Array[Flight] = Array(Flight(United States,Romania,1), Flight(United States,Ireland,264), Flight(United States,India,69), Flight(Egypt,United States,24), Flight(Equatorial Guinea,United States,1))</span></span><br><span class="line"><span class="comment">// res46: Array[Flight] = Array(Flight(United States,Romania,6), Flight(United States,Ireland,269), Flight(United States,India,74), Flight(Egypt,United States,29), Flight(Equatorial Guinea,United States,6))</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><strong>Dataset</strong> : Javaì™€ Scalaì˜ ì •ì  ë°ì´í„° íƒ€ì…ì— ë§ëŠ” ì½”ë“œ(statically typed code)ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ ìŠ¤íŒŒí¬ì˜ êµ¬ì¡°ì  API<ul>
<li>Python, R ì‚¬ìš© X</li>
</ul>
</li>
<li>Dataset API ëŠ” <strong>DataFrame ë ˆì½”ë“œ =&gt; Javaë‚˜ Scalaë¡œ ì •ì˜í•œ í´ë˜ìŠ¤ì— í• ë‹¹</strong>, Collection ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ë“±ì„ ì œê³µ<ul>
<li>DataFrame : ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì…ì˜ í…Œì´ë¸”í˜• ë°ì´í„°ë¥¼ ë³´ê´€í•  ìˆ˜ ìˆëŠ” Row íƒ€ì… ê°ì²´ë¡œ êµ¬ì„±ëœ ë¶„ì‚° ì»¬ë ‰ì…˜ (<a href="https://minsw.github.io/2021/01/24/Spark-The-Definitive-Guide-2%EC%9E%A5/#2-6-DataFrame">2ì¥ ì°¸ê³ </a>)</li>
<li><strong>íƒ€ì… ì•ˆì •ì„±ì„ ì§€ì›</strong> í•˜ë¯€ë¡œ ì´ˆê¸°í™”ì— ì‚¬ìš©í•œ í´ë˜ìŠ¤ ì™¸ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ì ‘ê·¼ì€ X</li>
<li>ì—¬ëŸ¬ ëª…ì´ ê°œë°œí•˜ê³  ì˜ ì •ì˜ëœ ì¸í„°í˜ì´ìŠ¤ë¡œ ìƒí˜¸ì‘ìš©í•˜ëŠ” ëŒ€ê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì— ìœ ìš©<br><del>ì˜ ì •ì˜ëœ ì¸í„°í˜ì´ìŠ¤ ë¶€í„°ê°€ ì‹¤íŒ¨ë‹¤ ì´ë§ì´ì•¼</del></li>
</ul>
</li>
<li>Dataset í´ë˜ìŠ¤ (Java <code>Dataset&lt;T&gt;</code>, Scala <code>Dataset[T]</code>)<ul>
<li>ë‚´ë¶€ ê°ì²´ íƒ€ì…ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš© (T) =&gt; í•´ë‹¹ í´ë˜ìŠ¤ ê°ì²´ë§Œ ê°€ì§ˆ ìˆ˜ ìˆìŒ</li>
<li>ìŠ¤íŒŒí¬ 2.0 ì—ì„œëŠ” ìë°”ì˜ JavaBean íŒ¨í„´, ìŠ¤ì¹¼ë¼ì˜ ì¼€ì´ìŠ¤ í´ë˜ìŠ¤ ìœ í˜•ìœ¼ë¡œ ì •ì˜ëœ í´ë˜ìŠ¤ ì§€ì›</li>
<li>íƒ€ì… Të¥¼ ë¶„ì„í•´ì„œ Dataset ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•´ì•¼í•˜ë¯€ë¡œ íƒ€ì…ì„ ì œí•œí•  ìˆ˜ ë°–ì— ì—†ìŒ</li>
</ul>
</li>
<li>ì¥ì <ul>
<li>í•„ìš”í•œ ê²½ìš° ì„ íƒì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ê³ , map, filter ë“± í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥</li>
<li>ì½”ë“œ ë³€ê²½ ì—†ì´ íƒ€ì… ì•ˆì •ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆê³ , ì•ˆì „í•˜ê²Œ ë°ì´í„° ë‹¤ë£¨ê¸° ê°€ëŠ¥<ul>
<li><code>collect()</code> ë‚˜ <code>take()</code> í˜¸ì¶œ ì‹œ DataFrameì˜ row íƒ€ì… ê°ì²´ê°€ ì•„ë‹Œ Datasetì˜ ì§€ì •ëœ íƒ€ì…(T)ì˜ ê°ì²´ë¡œ ë°˜í™˜</li>
</ul>
</li>
</ul>
</li>
<li>Datasetì˜ ìì„¸í•œ ë‚´ìš©ì€ CHAPTER 11 ì—ì„œ ì´ì–´ì„œ</li>
</ul>
<h3 id="3-3-êµ¬ì¡°ì -ìŠ¤íŠ¸ë¦¬ë°"><a href="#3-3-êµ¬ì¡°ì -ìŠ¤íŠ¸ë¦¬ë°" class="headerlink" title="3.3 êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°"></a>3.3 êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°</h3><details><summary class="point-color-can-hover">[3.3] ì˜ˆì œ í¼ì¹˜ê¸° (ì •ì  DataFrame ë²„ì „) </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ì •ì  DataFrame ë²„ì „</span></span><br><span class="line"><span class="keyword">val</span> staticDataFrame = (spark.read.format(<span class="string">&quot;csv&quot;</span>)</span><br><span class="line">  .option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">  .option(<span class="string">&quot;inferSchema&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">  .load(<span class="string">&quot;/data/retail-data/by-day/*.csv&quot;</span>))</span><br><span class="line"></span><br><span class="line">staticDataFrame.createOrReplaceTempView(<span class="string">&quot;retail_data&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> staticSchema = staticDataFrame.schema</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.&#123;window, column, desc, col&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x27;íŠ¹ì • ê³ ê°(CustomerId)ê°€ ëŒ€ëŸ‰ìœ¼ë¡œ êµ¬ë§¤í•˜ëŠ” ì˜ì—… ì‹œê°„&#x27; êµ¬í•˜ê¸°</span></span><br><span class="line">(staticDataFrame</span><br><span class="line">  .selectExpr(</span><br><span class="line">    <span class="string">&quot;CustomerId&quot;</span>,</span><br><span class="line">    <span class="string">&quot;(UnitPrice * Quantity) as total_cost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;InvoiceDate&quot;</span>)</span><br><span class="line">  .groupBy(</span><br><span class="line">    col(<span class="string">&quot;CustomerId&quot;</span>), window(col(<span class="string">&quot;InvoiceDate&quot;</span>), <span class="string">&quot;1 day&quot;</span>)) <span class="comment">// ê´€ë ¨ ë‚ ì§œ ë°ì´í„° ê·¸ë£¹í™” &amp; ì§‘ê³„</span></span><br><span class="line">  .sum(<span class="string">&quot;total_cost&quot;</span>)</span><br><span class="line">  .show(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"><span class="comment">// |CustomerId|              window|   sum(total_cost)|</span></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"><span class="comment">// |   14075.0|[2011-12-05 00:00...|316.78000000000003|</span></span><br><span class="line"><span class="comment">// |   18180.0|[2011-12-05 00:00...|            310.73|</span></span><br><span class="line"><span class="comment">// |   15358.0|[2011-12-05 00:00...| 830.0600000000003|</span></span><br><span class="line"><span class="comment">// |   15392.0|[2011-12-05 00:00...|304.40999999999997|</span></span><br><span class="line"><span class="comment">// |   15290.0|[2011-12-05 00:00...|263.02000000000004|</span></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ë¡œì»¬ ëª¨ë“œ ì‚¬ìš© ì‹œ ì…”í”Œ íŒŒí‹°ì…˜ ìˆ˜ (default 200) ì¤„ì´ê¸°ë¥¼ ê¶Œì¥. <code>spark.conf.set(&quot;spark.sql.shuffle.partitions&quot;, &quot;5&quot;)</code></p>
</blockquote>
</details>

<br/>

<details><summary class="point-color-can-hover">[3.3] ì˜ˆì œ í¼ì¹˜ê¸° (Streaming ë²„ì „) </summary>


<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Streaming ë²„ì „</span></span><br><span class="line"><span class="keyword">val</span> streamingDataFrame = (spark.readStream  <span class="comment">// read =&gt; readStream</span></span><br><span class="line">    .schema(staticSchema)</span><br><span class="line">    .option(<span class="string">&quot;maxFilesPerTrigger&quot;</span>, <span class="number">1</span>)  <span class="comment">// maxFilesPerTrigger (í•œë²ˆì— ì½ì„ íŒŒì¼ ìˆ˜ ì„¤ì •) =&gt; íŒŒì¼ë³„ë¡œ íŠ¸ë¦¬ê±° ìˆ˜í–‰</span></span><br><span class="line">    .format(<span class="string">&quot;csv&quot;</span>)</span><br><span class="line">    .option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">    .load(<span class="string">&quot;/data/retail-data/by-day/*.csv&quot;</span>))</span><br><span class="line"></span><br><span class="line">streamingDataFrame.isStreaming <span class="comment">// returns true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> purchaseByCustomerPerHour = (streamingDataFrame</span><br><span class="line">  .selectExpr(</span><br><span class="line">    <span class="string">&quot;CustomerId&quot;</span>,</span><br><span class="line">    <span class="string">&quot;(UnitPrice * Quantity) as total_cost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;InvoiceDate&quot;</span>)</span><br><span class="line">  .groupBy(</span><br><span class="line">    $<span class="string">&quot;CustomerId&quot;</span>, window($<span class="string">&quot;InvoiceDate&quot;</span>, <span class="string">&quot;1 day&quot;</span>))</span><br><span class="line">  .sum(<span class="string">&quot;total_cost&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1) ìŠ¤íŠ¸ë¦¼ ì‹œì‘ &amp; ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸”ì— ì €ì¥</span></span><br><span class="line">(purchaseByCustomerPerHour.writeStream</span><br><span class="line">    .format(<span class="string">&quot;memory&quot;</span>) <span class="comment">// memory = ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸”ì— ì €ì¥</span></span><br><span class="line">    .queryName(<span class="string">&quot;customer_purchases&quot;</span>) <span class="comment">// ì¸ë©”ëª¨ë¦¬ì— ì €ì¥ë  í…Œì´ë¸”ëª…</span></span><br><span class="line">    .outputMode(<span class="string">&quot;complete&quot;</span>) <span class="comment">// complete = ëª¨ë“  ì¹´ìš´íŠ¸ ìˆ˜í–‰ ê²°ê³¼ë¥¼ í…Œì´ë¸”ì— ì €ì¥</span></span><br><span class="line">    .start())</span><br><span class="line"></span><br><span class="line"><span class="comment">// ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸” í™•ì¸ (ë°ì´í„°ë¥¼ ë§ì´ ì½ìœ¼ë©´ ì½ì„ìˆ˜ë¡ í…Œì´ë¸” êµ¬ì„±ì´ ë³€ê²½)</span></span><br><span class="line">(spark.sql(<span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">  SELECT *</span></span><br><span class="line"><span class="string">  FROM customer_purchases</span></span><br><span class="line"><span class="string">  ORDER BY `sum(total_cost)` DESC</span></span><br><span class="line"><span class="string">  &quot;</span><span class="string">&quot;&quot;</span>)</span><br><span class="line">  .show(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"><span class="comment">// |CustomerId|              window|   sum(total_cost)|</span></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"><span class="comment">// |   17450.0|[2011-09-20 00:00...|          71601.44|</span></span><br><span class="line"><span class="comment">// |      null|[2011-11-14 00:00...|          55316.08|</span></span><br><span class="line"><span class="comment">// |      null|[2011-11-07 00:00...|          42939.17|</span></span><br><span class="line"><span class="comment">// |      null|[2011-03-29 00:00...| 33521.39999999998|</span></span><br><span class="line"><span class="comment">// |      null|[2011-12-08 00:00...|31975.590000000007|</span></span><br><span class="line"><span class="comment">// +----------+--------------------+------------------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2) ì²˜ë¦¬ê²°ê³¼ ì½˜ì†”ì— ì¶œë ¥</span></span><br><span class="line">(purchaseByCustomerPerHour.writeStream</span><br><span class="line">    .format(<span class="string">&quot;console&quot;</span>) <span class="comment">// console = ì½˜ì†”ì— ê²°ê³¼ ì¶œë ¥</span></span><br><span class="line">    .queryName(<span class="string">&quot;customer_purchases_2&quot;</span>)</span><br><span class="line">    .outputMode(<span class="string">&quot;complete&quot;</span>)</span><br><span class="line">    .start())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><strong>êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°</strong> : ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ìš© ê³ ìˆ˜ì¤€ API<ul>
<li>êµ¬ì¡°ì  APIë¡œ ê°œë°œëœ ë°°ì¹˜ ëª¨ë“œ ì—°ì‚°ì„ <strong>ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ</strong> ì‹¤í–‰ ê°€ëŠ¥í•˜ë©°, ì§€ì—° ì‹œê°„ì„ ì¤„ì´ê³  ì¦ë¶„ ì²˜ë¦¬ ê°€ëŠ¥</li>
<li>ì¦‰ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ë¡œ <u>ë¹ ë¥´ê²Œ ê°’ì„ ì–»ì„ ìˆ˜ ìˆê³ </u>, ëª¨ë“  ì‘ì—…ì—ì„œ ë°ì´í„°ë¥¼ <u>ì¦ë¶„ ì²˜ë¦¬</u>í•˜ë©´ì„œ ìˆ˜í–‰ëœë‹¤</li>
<li>ë°°ì¹˜ ì¡ìœ¼ë¡œ í”„ë¡œí† íƒ€ì… ê°œë°œ í›„ì— ìŠ¤íŠ¸ë¦¬ë° ì¡ìœ¼ë¡œ ë³€í™˜ë„ ê°€ëŠ¥</li>
<li>ìŠ¤íŒŒí¬ 2.2 ë²„ì „ë¶€í„° ì•ˆì •í™” (production-ready)</li>
</ul>
</li>
<li>ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•˜ê³  ì§‘ê³„í•˜ëŠ” ë°©ë²• (ì‹œê³„ì—´ time-series ë°ì´í„°  ì²˜ë¦¬)<ul>
<li><code>window()</code> : ì§‘ê³„ ì‹œì—, ì‹œê³„ì—´ ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ ê° ë‚ ì§œì— ëŒ€í•œ ì „ì²´ ë°ì´í„°ë¥¼ ê°€ì§€ëŠ” ìœˆë„ìš° êµ¬ì„± =&gt; ë‚ ì§œ, íƒ€ì„ìŠ¤íƒ¬í”„ ì²˜ë¦¬ì— ìœ ìš©</li>
</ul>
</li>
<li>ì •ì  DataFrame ì½”ë“œ vs ìŠ¤íŠ¸ë¦¬ë° ì½”ë“œ<ul>
<li><code>read</code> vs <code>readStream</code></li>
<li> ì¼ë°˜ì ì¸ ì •ì  ì•¡ì…˜ vs <strong>ìŠ¤íŠ¸ë¦¬ë° ì•¡ì…˜</strong></li>
<li>ìŠ¤íŠ¸ë¦¬ë° ì•¡ì…˜ì€ ì–´ë”˜ê°€ì— ë°ì´í„°ë¥¼ ì±„ì›Œë„£ì–´ì•¼í•¨. <strong>íŠ¸ë¦¬ê±°</strong>ê°€ ì‹¤í–‰ëœ í›„ ë°ì´í„°ë¥¼ ê°±ì‹ <ul>
<li>(ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸”ì— ì €ì¥ ì‹œ - ìŠ¤íŒŒí¬ëŠ” ì´ì „ ì§‘ê³„ê°’ë³´ë‹¤ ë” í° ê°’ì´ ë°œìƒí•  ë•Œë§Œ ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸” ê°±ì‹ )</li>
</ul>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://bit.ly/2PvOwCS">ì˜ˆì œ retail ë°ì´í„° ì…‹</a><ul>
<li>by-day í•˜ë£¨ ì¹˜ ë°ì´í„° ì‚¬ìš©</li>
<li>ì˜ˆì œëŠ” ì¸ë©”ëª¨ë¦¬ í…Œì´ë¸”ì— ì €ì¥ / íŒŒì¼ë§ˆë‹¤ íŠ¸ë¦¬ê±° ì‹¤í–‰</li>
<li>ì˜ˆì œì˜ ë‘ê°€ì§€ ë°©ì‹ (ë©”ëª¨ë¦¬/ì½˜ì†” ì¶œë ¥, íŒŒì¼ë³„ íŠ¸ë¦¬ê±° ìˆ˜í–‰)ì€ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ê¶Œì¥ X</li>
</ul>
</li>
<li>ë°ì´í„° ì²˜ë¦¬ ì‹œì ì´ ì•„ë‹Œ ì´ë²¤íŠ¸ ì‹œê°„ì— ë”°ë¼ ìœˆë„ìš°ë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ì‹ì— ì£¼ëª©<ul>
<li>ê¸°ì¡´ ìŠ¤íŒŒí¬ ìŠ¤íŠ¸ë¦¬ë°ì˜ ë‹¨ì  =&gt; <strong>êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ë³´ì™„</strong> ê°€ëŠ¥</li>
<li>ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ê³¼ì •ì˜ ìŠ¤í‚¤ë§ˆ ì¶”ë¡ ë°©ë²• ë° êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°ì€ CHAPTER 5 ì—ì„œ ìì„¸íˆ</li>
</ul>
</li>
</ul>
<h3 id="3-4-ë¨¸ì‹ ëŸ¬ë‹ê³¼-ê³ ê¸‰-ë¶„ì„"><a href="#3-4-ë¨¸ì‹ ëŸ¬ë‹ê³¼-ê³ ê¸‰-ë¶„ì„" class="headerlink" title="3.4 ë¨¸ì‹ ëŸ¬ë‹ê³¼ ê³ ê¸‰ ë¶„ì„"></a>3.4 ë¨¸ì‹ ëŸ¬ë‹ê³¼ ê³ ê¸‰ ë¶„ì„</h3><details><summary class="point-color-can-hover">[3.4] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MLlib ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ : ìˆ˜ì¹˜í˜• ë°ì´í„° í•„ìš”</span></span><br><span class="line"><span class="comment"># ì˜ˆì œì˜ (ì •ì ) ë°ì´í„° =&gt; ìˆ˜ì¹˜í˜•ìœ¼ë¡œ ë³€í™˜</span></span><br><span class="line"></span><br><span class="line">staticDataFrame.printSchema()</span><br><span class="line"></span><br><span class="line">root</span><br><span class="line"> |-- InvoiceNo: string (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- StockCode: string (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- Description: string (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- Quantity: <span class="built_in">integer</span> (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- InvoiceDate: timestamp (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- UnitPrice: double (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- CustomerID: double (nullable = <span class="literal">true</span>)</span><br><span class="line"> |-- Country: string (nullable = <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.date_format</span><br><span class="line"><span class="keyword">val</span> preppedDataFrame = (staticDataFrame</span><br><span class="line">  .na.fill(<span class="number">0</span>) <span class="comment">// 0ì¸ ê²½ìš° nullë¡œ ì±„ì›€</span></span><br><span class="line">  .withColumn(<span class="string">&quot;day_of_week&quot;</span>, date_format($<span class="string">&quot;InvoiceDate&quot;</span>, <span class="string">&quot;EEEE&quot;</span>)) <span class="comment">// Sunday, Monday, ..</span></span><br><span class="line">  .coalesce(<span class="number">5</span>)) <span class="comment">// íŒŒí‹°ì…˜ ê°œìˆ˜ ì¤„ì„ (default, shuffle = false)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) ë°ì´í„° =&gt; í•™ìŠµ ë°ì´í„°ì…‹, í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ìœ¼ë¡œ ë¶„ë¦¬ (2011-07-01 ê¸°ì¤€)</span></span><br><span class="line"><span class="keyword">val</span> trainDataFrame = (preppedDataFrame</span><br><span class="line">  .where(<span class="string">&quot;InvoiceDate &lt; &#x27;2011-07-01&#x27;&quot;</span>))</span><br><span class="line"><span class="keyword">val</span> testDataFrame = (preppedDataFrame</span><br><span class="line">  .where(<span class="string">&quot;InvoiceDate &gt;= &#x27;2011-07-01&#x27;&quot;</span>))</span><br><span class="line"></span><br><span class="line">trainDataFrame.count()</span><br><span class="line"><span class="comment">// res110: Long = 245903</span></span><br><span class="line">testDataFrame.count()   </span><br><span class="line"><span class="comment">// res111: Long = 296006</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// (2-1) ìš”ì¼(Sunday, Monday,..)ì„ ìˆ˜ì¹˜í˜•(0,1, ..)ìœ¼ë¡œ ë°˜í™˜</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.feature.<span class="type">StringIndexer</span></span><br><span class="line"><span class="keyword">val</span> indexer = (<span class="keyword">new</span> <span class="type">StringIndexer</span>()</span><br><span class="line">  .setInputCol(<span class="string">&quot;day_of_week&quot;</span>)</span><br><span class="line">  .setOutputCol(<span class="string">&quot;day_of_week_index&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2-2) ìˆ«ìë¡œ í‘œí˜„ëœ ë²”ì£¼í˜• ë°ì´í„° ì¸ì½”ë”© (í•´ë‹¹ ìš”ì¼ì¸ì§€ Boolean íƒ€ì…ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥)</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.feature.<span class="type">OneHotEncoder</span></span><br><span class="line"><span class="keyword">val</span> encoder = (<span class="keyword">new</span> <span class="type">OneHotEncoder</span>()</span><br><span class="line">  .setInputCol(<span class="string">&quot;day_of_week_index&quot;</span>)</span><br><span class="line">  .setOutputCol(<span class="string">&quot;day_of_week_encoded&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2-3) ìˆ˜ì¹˜í˜• ë²¡í„° íƒ€ì…ì„ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš© (ê°€ê²©, ìˆ˜ëŸ‰, íŠ¹ì • ë‚ ì§œì˜ ìš”ì¼)</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.feature.<span class="type">VectorAssembler</span></span><br><span class="line"><span class="keyword">val</span> vectorAssembler = (<span class="keyword">new</span> <span class="type">VectorAssembler</span>()</span><br><span class="line">  .setInputCols(<span class="type">Array</span>(<span class="string">&quot;UnitPrice&quot;</span>, <span class="string">&quot;Quantity&quot;</span>, <span class="string">&quot;day_of_week_encoded&quot;</span>))</span><br><span class="line">  .setOutputCol(<span class="string">&quot;features&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3) íŒŒì´í”„ë¼ì¸ ì„¤ì •</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.<span class="type">Pipeline</span></span><br><span class="line"><span class="keyword">val</span> transformationPipeline = (<span class="keyword">new</span> <span class="type">Pipeline</span>()</span><br><span class="line">  .setStages(<span class="type">Array</span>(indexer, encoder, vectorAssembler)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// (4) ë³€í™˜ì(transformer) ë¥¼ ë°ì´í„°ì…‹ì— ì í•©(fit) =&gt; &#x27;fitted pipeline&#x27;</span></span><br><span class="line"><span class="comment">// ì¼ê´€ë˜ê³  ë°˜ë³µëœ ë°©ì‹ìœ¼ë¡œ ë°ì´í„° ë³€í™˜ ê°€ëŠ¥. í•™ìŠµ ë°ì´í„°ì…‹ ìƒì„± ì™„ë£Œ</span></span><br><span class="line"><span class="keyword">val</span> fittedPipeline = transformationPipeline.fit(trainDataFrame)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> transformedTraining = fittedPipeline.transform(trainDataFrame)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ìºì‹± ì‚¬ìš©ì‹œ ì¤‘ê°„ ë³€í™”ëœ ë°ì´í„°ì…‹ì˜ ë³µì‚¬ë³¸ì„ ë©”ëª¨ë¦¬ì— ì €ì¥. ì „ì²´ íŒŒì´í”„ë¼ì¸ ì¬ì‹¤í–‰ë³´ë‹¤ í›¨ì”¬ ë¹ ë¥´ë‹¤</span></span><br><span class="line"><span class="comment">// ê·¼ë° ì™œë•Œë¬¸ì— ë‚˜ëŠ” ë” ëŠë¦° ê²ƒ..? ã….. CHAPTER 4 ì—ì„œ ë‹¤ì‹œ í™•ì¸í•˜ì</span></span><br><span class="line">transformedTraining.cache()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// (5) ëª¨ë¸ í•™ìŠµ (kmeans ëª¨ë¸ ì„¤ì • ê³¼ì •ì€ ìƒëµ..)</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.clustering.<span class="type">KMeans</span></span><br><span class="line"><span class="keyword">val</span> kmeans = (<span class="keyword">new</span> <span class="type">KMeans</span>()</span><br><span class="line">  .setK(<span class="number">20</span>)</span><br><span class="line">  .setSeed(<span class="number">1</span>L))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> kmModel = kmeans.fit(transformedTraining)</span><br><span class="line"></span><br><span class="line"><span class="comment">// (6) í•™ìŠµ ë°ì´í„°ì…‹ì— ëŒ€í•œ ë¹„ìš© (êµ°ì§‘ ë¹„ìš©) ê³„ì‚°</span></span><br><span class="line">kmModel.computeCost(transformedTraining)</span><br><span class="line"><span class="comment">// res146: Double = 8.455373996537486E7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ê³¼ ë¹„êµ</span></span><br><span class="line"><span class="comment">// ëª¨ë¸ ê°œì„  ë°©ë²•ì€ CHAPTER 6 ì—ì„œ</span></span><br><span class="line"><span class="keyword">val</span> transformedTest = fittedPipeline.transform(testDataFrame)</span><br><span class="line">kmModel.computeCost(transformedTest)</span><br><span class="line"><span class="comment">// res150: Double = 5.175070947222117E8</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><p>ë‚´ì¥ëœ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ MLlib ì‚¬ìš©í•œ ëŒ€ê·œëª¨ ë¨¸ì‹ ëŸ¬ë‹ ê°€ëŠ¥</p>
<ul>
<li>ëŒ€ìš©ëŸ‰ ë°ì´í„° ëŒ€ìƒì˜ ì „ì²˜ë¦¬(proprocessing), ë©ì‰(munging), ëª¨ë¸ í•™ìŠµ(model training), ì˜ˆì¸¡(prediction)</li>
<li>êµ¬ì¡°ì  ìŠ¤íŠ¸ë¦¬ë°ì—ì„œ ì˜ˆì¸¡í•˜ê³ ì í• ë•Œë„ ì˜ˆì¸¡ ëª¨ë¸ ì‚¬ìš© ê°€ëŠ¥</li>
</ul>
</li>
<li><p>ìŠ¤íŒŒí¬ëŠ” ë¶„ë¥˜(classification), íšŒê·€(regression), êµ°ì§‘í™”(clustering), ë”¥ëŸ¬ë‹(deep learning) ê°™ì€ ë¨¸ì‹ ëŸ¬ë‹ ê´€ë ¨ ì •êµí•œ API ì œê³µ</p>
<ul>
<li>ë‘ìœ  ë…¸- <code>k-í‰ê· </code> ? : êµ°ì§‘í™” í‘œì¤€ ì•Œê³ ë¦¬ì¦˜. ì„¼íŠ¸ë¡œì´ë“œ(centroid)ë¼ëŠ” ì¤‘ì‹¬ì ì„ ì‚¬ìš©í•´ì„œ.. <code>p.99 ì°¸ê³ </code></li>
</ul>
</li>
<li><p>k-í‰ê· ì„ ì‚¬ìš©í•œ ì˜ˆì œ</p>
<ul>
<li>ì›ë³¸ ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥¸ í¬ë§·ìœ¼ë¡œ ë§Œë“œëŠ” íŠ¸ë ŒìŠ¤í¬ë©”ì´ì…˜ ì •ì˜. ì‹¤ì œ ëª¨ë¸ í•™ìŠµ í›„ ë‹¤ìŒ ì˜ˆì¸¡ ìˆ˜í–‰</li>
</ul>
</li>
<li><p>ìŠ¤íŒŒí¬ (MLlib DataFrame API) ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ ê³¼ì • 2ë‹¨ê³„</p>
<ol>
<li>ì•„ì§ í•™ìŠµë˜ì§€ ì•Šì€ ëª¨ë¸ ì´ˆê¸°í™”</li>
<li>í•´ë‹¹ ëª¨ë¸ì„ í•™ìŠµ</li>
</ol>
</li>
</ul>
<blockquote>
<p>ì•Œê³ ë¦¬ì¦˜ ëª…ëª… ê·œì¹™ </p>
<ul>
<li>í•™ìŠµ ì „ ì•Œê³ ë¦¬ì¦˜ ëª…ì¹­ : {Algorithm_name}</li>
<li>í•™ìŠµ í›„ ì•Œê³ ë¦¬ì¦˜ ëª…ì¹­ : {Algorithm_name} + â€˜Modelâ€™</li>
</ul>
</blockquote>
<h3 id="3-5-ì €ìˆ˜ì¤€-API"><a href="#3-5-ì €ìˆ˜ì¤€-API" class="headerlink" title="3.5 ì €ìˆ˜ì¤€ API"></a>3.5 ì €ìˆ˜ì¤€ API</h3><ul>
<li>ìŠ¤íŒŒí¬ëŠ” <strong>RDD</strong> ë¥¼ í†µí•´ ìë°”ì™€ íŒŒì´ì¬ ê°ì²´ë¥¼ ë‹¤ë£¨ëŠ”ë° í•„ìš”í•œ ë‹¤ì–‘í•œ ê¸°ë³¸ ê¸°ëŠ¥ (ì €ìˆ˜ì¤€ API) ì œê³µ<ul>
<li>DataFrameì„ í¬í•¨í•´ì„œ ìŠ¤íŒŒí¬ì˜ ê±°ì˜ ëª¨ë“  ê¸°ëŠ¥ì´ RDD ê¸°ë°˜</li>
<li>ì €ìˆ˜ì¤€ ëª…ë ¹ìœ¼ë¡œ ì»´íŒŒì¼ =&gt; í¸ë¦¬í•˜ê³  ë§¤ìš° íš¨ìœ¨ì ì¸ ë¶„ì‚°ì²˜ë¦¬</li>
</ul>
</li>
<li>ì›ì‹œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ìš©ë„ë¡œë„ ì“¸ ìˆ˜ëŠ” ìˆì§€ë§Œ, ëŒ€ë¶€ë¶„ êµ¬ì¡°ì  API ì‚¬ìš©ì´ ë” ë‚«ë‹¤<ul>
<li>ëŒ€ì‹  íŒŒí‹°ì…˜ê³¼ ê°™ì€ <strong>ë¬¼ë¦¬ì  ì‹¤í–‰ íŠ¹ì„±ì„ ê²°ì •</strong> í•  ìˆ˜ ìˆì–´, ì„¸ë°€í•œ ì œì–´ê°€ ê°€ëŠ¥</li>
<li>ë¹„ì •í˜• ë°ì´í„°, ì •ì œë˜ì§€ ì•Šì€ ì›ì‹œ ë°ì´í„° ì²˜ë¦¬ì— ì‚¬ìš©</li>
</ul>
</li>
<li>ì–¸ì–´ì— ë”°ë¼ RDD ì„¸ë¶€ êµ¬í˜„ì— ì°¨ì´ê°€ ìˆìŒ<ul>
<li>Scala, Python ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ RDDê°€ ë™ì¼í•˜ì§€ X</li>
<li>(&lt;-&gt; ì–¸ì–´ì— ê´€ê³„ì—†ì´ ë™ì¼í•œ ì‹¤í–‰ íŠ¹ì„±ì˜ DataFrame API)</li>
</ul>
</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë©”ëª¨ë¦¬ì— ì €ì¥ëœ ì›ì‹œ ë°ì´í„°ë¥¼ ë³‘ë ¬ ì²˜ë¦¬ (parallize) í•˜ì—¬ RDD[Int] ìƒì„± í›„ DataFrameìœ¼ë¡œ ë³€í™˜</span></span><br><span class="line">spark.sparkContext.parallelize(<span class="type">Seq</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)).toDF()</span><br></pre></td></tr></table></figure>
<h3 id="3-6-SparkR"><a href="#3-6-SparkR" class="headerlink" title="3.6 SparkR"></a>3.6 SparkR</h3><ul>
<li>SparkR : ìŠ¤íŒŒí¬ë¥¼ Rì–¸ì–´ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê¸°ëŠ¥<ul>
<li>íŒŒì´ì¬ API ì™€ ìœ ì‚¬í•˜ê³ , íŒŒì´ì¬ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì€ ëŒ€ë¶€ë¶„ ì‚¬ìš© ê°€ëŠ¥</li>
<li>R ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©í•˜ì—¬ ìŠ¤íŒŒí¬ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ê³¼ì •ì„ Rê³¼ ìœ ì‚¬í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŒ</li>
<li>CHAPTER 7ì—ì„œ ìì„¸íˆ ì•Œì•„ë³´ì</li>
</ul>
</li>
</ul>
<h3 id="3-7-ìŠ¤íŒŒí¬ì˜-ì—ì½”ì‹œìŠ¤í…œê³¼-íŒ¨í‚¤ì§€"><a href="#3-7-ìŠ¤íŒŒí¬ì˜-ì—ì½”ì‹œìŠ¤í…œê³¼-íŒ¨í‚¤ì§€" class="headerlink" title="3.7 ìŠ¤íŒŒí¬ì˜ ì—ì½”ì‹œìŠ¤í…œê³¼ íŒ¨í‚¤ì§€"></a>3.7 ìŠ¤íŒŒí¬ì˜ ì—ì½”ì‹œìŠ¤í…œê³¼ íŒ¨í‚¤ì§€</h3><ul>
<li>ìŠ¤íŒŒí¬ì˜ ìµœê³  ìë‘ = ì»¤ë®¤ë‹ˆí‹°ê°€ ë§Œë“¤ì–´ë‚¸ íŒ¨í‚¤ì§€ ì—ì½”ì‹œìŠ¤í…œ &amp; ë‹¤ì–‘í•œ ê¸°ëŠ¥<ul>
<li>ìŠ¤íŒŒí¬ íŒ¨í‚¤ì§€ ì €ì¥ì†Œ : <a target="_blank" rel="noopener" href="https://spark-packages.org/">https://spark-packages.org/</a></li>
<li>ê·¸ ì™¸ ê¹ƒí—™, ê¸°íƒ€ ì›¹ì‚¬ì´íŠ¸ â€¦</li>
</ul>
</li>
</ul>
<h3 id="3-8-ì •ë¦¬"><a href="#3-8-ì •ë¦¬" class="headerlink" title="3.8 ì •ë¦¬"></a>3.8 ì •ë¦¬</h3><ul>
<li>ìŠ¤íŒŒí¬ë¥¼ ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ê¸°ìˆ ì  ë¬¸ì œ í•´ê²°ì— ì ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë°©ë²•<ul>
<li>ë‹¨ìˆœí•˜ê³  ê°•ë ¥í•œ í”„ë¡œê·¸ë˜ë° ëª¨ë¸, ì†ì‰¬ìš´ ì ìš©</li>
<li>ë‹¤ì–‘í•œ íŒ¨í‚¤ì§€ëŠ” ì—¬ëŸ¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì œë¥¼ ì„±ê³µì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ìŠ¤íŒŒí¬ì˜ ëŠ¥ë ¥ì— ëŒ€í•œ ì¦ê±°</li>
<li>ë” ì„±ì¥í•˜ë„ë¡ ë” ë§ì€ íŒ¨í‚¤ì§€ê°€ ë§Œë“¤ì–´ì§ˆê±°ë‹¤~</li>
</ul>
</li>
</ul>
<h3 id="ğŸ“’-ë‹¨ì–´ì¥"><a href="#ğŸ“’-ë‹¨ì–´ì¥" class="headerlink" title="ğŸ“’ ë‹¨ì–´ì¥"></a>ğŸ“’ ë‹¨ì–´ì¥</h3><ul>
<li>ì •ì  íƒ€ì… ì½”ë“œ/ì–¸ì–´ (Statically typed) : ìë£Œí˜•ì´ ê³ ì •ëœ ì–¸ì–´. ì»´íŒŒì¼ ë•Œ ë³€ìˆ˜ íƒ€ì…ì´ ê²°ì • (ex. Java, Scala, C, C++ ë“±)<ul>
<li>&lt;-&gt; ë™ì  íƒ€ì… ì–¸ì–´ (Dynamically typed) : ëŸ°íƒ€ì„ì— ë³€ìˆ˜ íƒ€ì…ì´ ê²°ì • (ex. Python, JavaScript ë“±)</li>
</ul>
</li>
<li>ë©ì‰ (munging) : =data wrangling. ì›ë³¸ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ í˜•íƒœë¡œ ë³€í™˜í•˜ê±°ë‚˜ ë§¤í•‘í•˜ëŠ” ê³¼ì •</li>
</ul>
</div><p class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/study/">#study</a><a href="/tags/book/">#book</a><a href="/tags/spark/">#spark</a><a href="/tags/apache/">#apache</a></p></article></div><footer><div class="paginator"><a class="next" href="/2021/01/24/Spark-The-Definitive-Guide-2%EC%9E%A5/">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'minsw-github-io';
var disqus_identifier = '2021/01/24/Spark-The-Definitive-Guide-3ì¥/';
var disqus_title = '&amp;#039;Spark The Definitive Guide&amp;#039; 3ì¥ - ì¼ë‹¨ ì¢€ ë” ì¡ì†¨ë´ (PART 1 ë)';
var disqus_url = 'https://minsw.github.io/2021/01/24/Spark-The-Definitive-Guide-3ì¥/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>Â© 2018 - 2021 <a href="https://minsw.github.io">Lukka Min</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-143001954-1",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script></body></html>