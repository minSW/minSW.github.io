<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> &#039;Spark The Definitive Guide&#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚° Â· Look out</title><meta name="description" content="&amp;#039;Spark The Definitive Guide&amp;#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚° - Lukka Min"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/cover.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="search" type="application/opensearchdescription+xml" href="https://minsw.github.io/atom.xml" title="Look out"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/feed.xml" title="Look out" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/cover.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/tags/" target="_self">TAG</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/minSW" target="_blank">GITHUB</a></li></ul></header><main class="container"></main><div class="post"><article class="post-block"><h1 class="post-title">&#039;Spark The Definitive Guide&#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°</h1><div class="post-info">2021ë…„ 1ì›” 26ì¼<span class="categories"><i class="fa fa-bookmark" aria-hidden="true"></i></span><a class="post-category" href="/categories/spark/">#spark</a></div><div class="post-content"><br/>

<p>ì˜¤ëŠ˜ì˜ êµí›ˆ.<br>ë„ì»¤ ì´ë¯¸ì§€ì— ì˜ˆì œ ìˆë‹¤ê³  ì‹ ë‚˜ê²Œ ëŒë¦¬ê³ ~ ëŒë¦¬ê³ ~ í•˜ë‹¤ë³´ë©´<br>í„°ì§„ë‹¤ëŠ”ê±¸ ëª…ì‹¬í•˜ë„ë¡ í•˜ì ğŸ¥º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.io.IOException: No space left on device</span><br></pre></td></tr></table></figure>
<br/>

<img src="https://user-images.githubusercontent.com/26691216/106086744-1b72d100-6166-11eb-8d99-1deebfa68867.jpg" width="400" alt="jongman">
<center><i style="color:lightgray"> ì¸ìƒì€ ì‹¤ì „ì´ì•¼ ì¹œêµ¬ì•„</i></center>

<img width="300" alt="bomb" src="https://user-images.githubusercontent.com/26691216/106087261-fcc10a00-6166-11eb-80c2-d339e59bbc99.png">



<center><h2>_ _ _</h2></center>

<br/>

<hr>
<h1 id="CHAPTER-5-êµ¬ì¡°ì -API-ê¸°ë³¸-ì—°ì‚°"><a href="#CHAPTER-5-êµ¬ì¡°ì -API-ê¸°ë³¸-ì—°ì‚°" class="headerlink" title="CHAPTER 5 êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°"></a>CHAPTER 5 êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°</h1><p>CHAPTER 4 ëŠ” êµ¬ì¡°ì  APIì˜ í•µì‹¬ ì¶”ìƒí™” â€˜ê°œë…â€™ì„ ì†Œê°œ<br>CHAPTER 5 ëŠ” DataFrameê³¼ ê·¸ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ë³¸ â€˜ê¸°ëŠ¥â€™ ì†Œê°œ</p>
<blockquote>
<p><em>â€˜DataFrame = Row íƒ€ì…ì˜ <strong>ë ˆì½”ë“œ</strong> + ì—¬ëŸ¬ <strong>ì»¬ëŸ¼</strong>â€˜</em><br>(ê° ì»¬ëŸ¼ëª…ê³¼ ë°ì´í„° íƒ€ì…ì€ <strong>ìŠ¤í‚¤ë§ˆ</strong>ë¡œ ì •ì˜)</p>
<p>DataFrameì˜ <strong>íŒŒí‹°ì…”ë‹</strong> :  DataFrame (ë˜ëŠ” Dataset)ì´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë¬¼ë¦¬ì ìœ¼ë¡œ ë°°ì¹˜ë˜ëŠ” í˜•íƒœë¥¼ ì •ì˜</p>
<ul>
<li><strong>íŒŒí‹°ì…”ë‹ ìŠ¤í‚¤ë§ˆ</strong> : íŒŒí‹°ì…˜ì„ ë°°ì¹˜í•˜ëŠ” ë°©ë²• ì •ì˜</li>
<li>íŒŒí‹°ì…”ë‹ì˜ ë¶„í•  ê¸°ì¤€? =&gt; íŠ¹ì • ì»¬ëŸ¼ or ë¹„ê²°ì •ë¡ ì (nondeterministically) ê°’ ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •</li>
</ul>
</blockquote>
<h3 id="5-1-ìŠ¤í‚¤ë§ˆ"><a href="#5-1-ìŠ¤í‚¤ë§ˆ" class="headerlink" title="5.1 ìŠ¤í‚¤ë§ˆ"></a>5.1 ìŠ¤í‚¤ë§ˆ</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> df = spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>)</span><br><span class="line">df.printSchema()</span><br><span class="line"></span><br><span class="line"><span class="comment">// root</span></span><br><span class="line"><span class="comment">//  |-- DEST_COUNTRY_NAME: string (nullable = true)</span></span><br><span class="line"><span class="comment">//  |-- ORIGIN_COUNTRY_NAME: string (nullable = true)</span></span><br><span class="line"><span class="comment">//  |-- count: long (nullable = true)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ìŠ¤í‚¤ë§ˆëŠ” <strong>DataFrameì˜ ì»¬ëŸ¼ëª…ê³¼ ë°ì´í„° íƒ€ì…ì„ ì •ì˜</strong></p>
<ul>
<li>ê´€ë ¨ëœ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ì—­í• </li>
</ul>
</li>
<li><p>ë°ì´í„° ì†ŒìŠ¤ì—ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ì–»ê±°ë‚˜ (Schema-on-read), ì§ì ‘ ì •ì˜ ê°€ëŠ¥</p>
<ul>
<li>ëŒ€ë¶€ë¶„ì˜ ë¹„ì •í˜• ë¶„ì„ (ad-hoc analysis)ì—ì„œ schema-on-read ì˜ ë™ì‘</li>
<li>ìš´ì˜ í™˜ê²½ ETL ì‘ì—…ì— ìŠ¤íŒŒí¬ ì‚¬ìš©ì‹œ <strong>ì§ì ‘ ì •ì˜ í•„ìš”</strong> (ìƒ˜í”Œ ë°ì´í„° íƒ€ì…ì— ë”°ë¥¸ ìŠ¤í‚¤ë§ˆ ì¶”ë¡  ë°©ì§€)</li>
</ul>
</li>
<li><p>ìŠ¤í‚¤ë§ˆëŠ” <code>StructType</code> ê°ì²´ </p>
<ul>
<li><p>ë³µí•© ë°ì´í„° íƒ€ì… <code>StructType</code> (=consistOf(<code>StructField</code> ê°ì²´))</p>
</li>
<li><p>ìŠ¤íŒŒí¬ëŠ” ìì²´ ë°ì´í„° íƒ€ì… ì •ë³´ë¥¼ ì‚¬ìš© =&gt; ì–¸ì–´ ë³„ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì„¤ì • X</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>).schema</span><br><span class="line"><span class="comment">// res176: org.apache.spark.sql.types.StructType</span></span><br><span class="line"><span class="comment">//  = StructType(</span></span><br><span class="line"><span class="comment">//        StructField(DEST_COUNTRY_NAME,StringType,true),</span></span><br><span class="line"><span class="comment">//        StructField(ORIGIN_COUNTRY_NAME,StringType,true),</span></span><br><span class="line"><span class="comment">//        StructField(count,LongType,true)</span></span><br><span class="line"><span class="comment">//      )</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<details><summary class="point-color-can-hover">[5.1] ì˜ˆì œ í¼ì¹˜ê¸° - DataFrameì— ìŠ¤í‚¤ë§ˆ ì ìš© ì˜ˆì œ</summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataFrameì— ìŠ¤í‚¤ë§ˆë¥¼ ë§Œë“¤ê³  ì ìš©í•˜ëŠ” ì˜ˆì œ</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">StructField</span>, <span class="type">StructType</span>, <span class="type">StringType</span>, <span class="type">LongType</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.<span class="type">Metadata</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> myManualSchema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;count&quot;</span>, <span class="type">LongType</span>, <span class="literal">false</span>,</span><br><span class="line">    <span class="type">Metadata</span>.fromJson(<span class="string">&quot;&#123;\&quot;hello\&quot;:\&quot;world\&quot;&#125;&quot;</span>))</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> df = (spark.read.format(<span class="string">&quot;json&quot;</span>).schema(myManualSchema)</span><br><span class="line">  .load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>))</span><br></pre></td></tr></table></figure>
</details>


<h3 id="5-2-ì»¬ëŸ¼ê³¼-í‘œí˜„ì‹"><a href="#5-2-ì»¬ëŸ¼ê³¼-í‘œí˜„ì‹" class="headerlink" title="5.2 ì»¬ëŸ¼ê³¼ í‘œí˜„ì‹"></a>5.2 ì»¬ëŸ¼ê³¼ í‘œí˜„ì‹</h3><ul>
<li><p>ìŠ¤íŒŒí¬ì˜ â€˜ì»¬ëŸ¼â€™ (=í‘œí˜„ì‹)</p>
<ul>
<li>ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸, Rì˜ dataframe, Pandasì˜ ì»¬ëŸ¼ê³¼ ë¹„ìŠ·</li>
<li>ì‚¬ìš©ìëŠ” <u><strong>í‘œí˜„ì‹</strong></u>ìœ¼ë¡œ DataFrameì˜ ì»¬ëŸ¼ì„ ì„ íƒ, ì¡°ì‘, ì œê±° ê°€ëŠ¥</li>
<li>ì¦‰ í‘œí˜„ì‹ì„ ì‚¬ìš©í•´ ë ˆì½”ë“œ ë‹¨ìœ„ë¡œ ê³„ì‚°í•œ ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” ë…¼ë¦¬ì  êµ¬ì¡°. ì‹¤ì œê°’ì„ ì–»ìœ¼ë ¤ë©´ ë¡œìš° (=&gt; DataFrame) ê°€ í•„ìš”</li>
<li>ì™¸ë¶€ ì ‘ê·¼ì‹œ <strong>ë°˜ë“œì‹œ DataFrame ì„ í†µí•´ì•¼ í•¨</strong></li>
</ul>
</li>
<li><p>ì»¬ëŸ¼ ìƒì„± &amp; ì°¸ì¡° : <code>col()</code> <code>column()</code></p>
<ul>
<li>ì»¬ëŸ¼ì´ DataFrameì— ìˆëŠ”ì§€ ì—†ëŠ”ì§€ëŠ” ëª¨ë¦„ =&gt; <strong>ë¶„ì„ê¸°</strong>ê°€ <strong>ì¹´íƒˆë¡œê·¸</strong>ì— ì €ì¥ëœ ì •ë³´ë‘ ë¹„êµí•˜ê¸° ì „ê¹Œì§€ëŠ” ë¯¸í™•ì¸ <a href="https://minsw.github.io/2021/01/26/Spark-The-Definitive-Guide-4%EC%9E%A5/#4-4-%EA%B5%AC%EC%A1%B0%EC%A0%81-API%EC%9D%98-%EC%8B%A4%ED%96%89-%EA%B3%BC%EC%A0%95">[4.4] ì°¸ê³ </a></li>
<li>ìŠ¤ì¹¼ë¼ëŠ” ê³ ìœ  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ : <code>$&quot;ì»¬ëŸ¼ëª…&quot;</code> <code>&#39;ì»¬ëŸ¼ëª…</code> (<code>&#39;</code> : í‹± ë§ˆí¬, ì‹¬ë²Œ)</li>
<li>ëª…ì‹œì  ì°¸ì¡° : <code>DataFrame.col()</code> (ì¡°ì¸ì‹œ ìœ ìš©)<br>=&gt; ëª…ì‹œì  ì»¬ëŸ¼ ì •ì˜ ì‹œ, ë¶„ì„ê¸° ì‹¤í–‰ ë‹¨ê³„ì—ì„œ ì»¬ëŸ¼ í™•ì¸ ì ˆì°¨ ìƒëµ</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.&#123;col, column&#125;</span><br><span class="line">col(<span class="string">&quot;someCol&quot;</span>)</span><br><span class="line">column(<span class="string">&quot;someCol&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Scala</span></span><br><span class="line">$<span class="string">&quot;someCol&quot;</span></span><br><span class="line"><span class="symbol">&#x27;someCol</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ëª…ì‹œì  ì°¸ì¡°</span></span><br><span class="line">df.col(<span class="string">&quot;someCol&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><strong>í‘œí˜„ì‹</strong> : <code>expr()</code></p>
<ul>
<li>DataFrame ë ˆì½”ë“œì˜ ì—¬ëŸ¬ ê°’ì— ëŒ€í•œ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ì§‘í•©</li>
<li>ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ì…ë ¥ë°›ì•„ ì‹ë³„ -&gt; ë‹¤ì–‘í•œ í‘œí˜„ì‹ì„ ê° ë ˆì½”ë“œì— ì ìš© -&gt; <strong>â€˜ë‹¨ì¼ê°’â€™</strong> (ë³µí•© ë°ì´í„° íƒ€ì…) ìœ¼ë¡œ ì¶œë ¥ í•˜ëŠ” í•¨ìˆ˜</li>
<li><em>DataFrameì˜ ì»¬ëŸ¼ì€ â€˜í‘œí˜„ì‹â€™ì´ë‹¤</em><ul>
<li><code>expr(&quot;someCol&quot;)</code> == <code>col(&quot;someCol&quot;)</code> (ë™ì¼ ë™ì‘)</li>
<li>ì»¬ëŸ¼ì€ í‘œí˜„ì‹ì˜ ì¼ë¶€ ê¸°ëŠ¥ ì œê³µ</li>
</ul>
</li>
</ul>
</li>
<li><p>ìŠ¤íŒŒí¬ëŠ” ì—°ì‚° ìˆœì„œë¥¼ ì§€ì •í•˜ëŠ” ë…¼ë¦¬ì  íŠ¸ë¦¬ë¡œ ì»´íŒŒì¼</p>
<ul>
<li>DataFrame ì½”ë“œë‚˜ SQL í‘œí˜„ì‹ ì‘ì„± ì‹œ, ì‹¤í–‰ ì‹œì ì— ë™ì¼í•œ ë…¼ë¦¬ íŠ¸ë¦¬ë¡œ ì»´íŒŒì¼ ë˜ë¯€ë¡œ ë™ì¼í•œ ì„±ëŠ¥ ë°œíœ˜</li>
<li>ì˜ˆì‹œëŠ” <code>p.129</code> [ê·¸ë¦¼ 5-1] ë…¼ë¦¬ì  íŠ¸ë¦¬ DAG ì°¸ê³ </li>
<li><code>expr(&quot;someCol - 5&quot;)</code> == <code>col(&quot;someCol&quot;) - 5</code> == <code>expr(&quot;someCol&quot;) - 5</code>  (ë‹¤ ê°™ì€ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ê³¼ì •)</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë™ì¼í•œ í‘œí˜„ - col(), expr()</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.expr</span><br><span class="line">expr(<span class="string">&quot;(((someCol + 5) * 200) - 6) &lt; otherCol&quot;</span>)</span><br><span class="line"></span><br><span class="line">(((col(<span class="string">&quot;someCol&quot;</span>) + <span class="number">5</span>) * <span class="number">200</span>) - <span class="number">6</span>) &lt; col(<span class="string">&quot;otherCol&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataFrame ì»¬ëŸ¼ ì ‘ê·¼ (printScheme() ì•„ë‹Œ í”„ë¡œê·¸ë˜ë° ë°©ì‹)</span></span><br><span class="line">spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>).columns</span><br><span class="line"><span class="comment">// res0: Array[String] = Array(DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count)</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>â€˜í‘œí˜„ì‹â€™ ê³¼ â€˜ì»¬ëŸ¼â€™ ì‚¬ì´ í•µì‹¬ ë‚´ìš©</p>
<ul>
<li>ì»¬ëŸ¼ì€ ë‹¨ì§€ í‘œí˜„ì‹ì¼ ë¿</li>
<li>ì»¬ëŸ¼ê³¼ ì»¬ëŸ¼ì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ì€ íŒŒì‹±ëœ í‘œí˜„ì‹ê³¼ ë™ì¼í•œ ë…¼ë¦¬ì  ì‹¤í–‰ ê³„íšìœ¼ë¡œ ì»´íŒŒì¼</li>
</ul>
</blockquote>
<h3 id="5-3-ë ˆì½”ë“œì™€-ë¡œìš°"><a href="#5-3-ë ˆì½”ë“œì™€-ë¡œìš°" class="headerlink" title="5.3 ë ˆì½”ë“œì™€ ë¡œìš°"></a>5.3 ë ˆì½”ë“œì™€ ë¡œìš°</h3><ul>
<li>ìŠ¤íŒŒí¬ì˜ â€˜ë¡œìš°â€™ (=ë ˆì½”ë“œ)<ul>
<li>ìŠ¤íŒŒí¬ì—ì„œ DataFrameì˜ ê° ë¡œìš°ëŠ” í•˜ë‚˜ì˜ ë ˆì½”ë“œ</li>
<li>ê°’ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì»¬ëŸ¼ í‘œí˜„ì‹ìœ¼ë¡œ Row ê°ì²´ë¥¼ ë‹¤ë£¸</li>
<li>Row ê°ì²´ëŠ” ë‚´ë¶€ ë°”ì´íŠ¸ ë°°ì—´ì„ ê°€ì§€ëŠ” ì¸í„°í˜ì´ìŠ¤ =&gt; <strong>ì˜¤ì§ ì»¬ëŸ¼ í‘œí˜„ì‹ìœ¼ë¡œë§Œ</strong> ë‹¤ë£° ìˆ˜ ìˆìŒ (ì™¸ë¶€ ë…¸ì¶œ X)<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Row í™•ì¸</span></span><br><span class="line">scala&gt; df.first()</span><br><span class="line"><span class="comment">// res1: org.apache.spark.sql.Row = [United States,Romania,15]</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>ë¡œìš° ìƒì„±<ul>
<li>ê° ì»¬ëŸ¼ì— í•´ë‹¹í•˜ëŠ” ê°’ìœ¼ë¡œ ì§ì ‘ Row ê°ì²´ ìƒì„± ê°€ëŠ¥</li>
<li>ê·¸ëŸ¬ë‚˜ Row ê°ì²´ëŠ” ìŠ¤í‚¤ë§ˆ ì •ë³´ X (=&gt; ì˜¤ì§ DataFrameë§Œ ê°€ì§)</li>
<li>=&gt; ìŠ¤í‚¤ë§ˆë‘ ê°™ì€ ìˆœì„œë¡œ ê°’ ëª…ì‹œí•´ì•¼í•¨</li>
</ul>
</li>
<li>ë¡œìš° ë°ì´í„° ì ‘ê·¼í•˜ë ¤ë©´ =&gt; ì›í•˜ëŠ” ìœ„ì¹˜ ì§€ì •<ul>
<li>Python, R ì€ ì˜¬ë°”ë¥¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì•Œì•„ì„œ ë³€í™˜ë¨</li>
<li>Scala, Java ëŠ” í—¬í¼ ë©”ì„œë“œë‚˜ ë°ì´í„°íƒ€ì… ëª…ì‹œì  ì§€ì • í•„ìš” (Dataset API ì‚¬ìš© ì‹œ jvm ê°ì²´ ë°ì´í„° ì…‹ ì–»ì„ ìˆ˜ ìˆìŒ)<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"><span class="keyword">val</span> myRow = <span class="type">Row</span>(<span class="string">&quot;Hello&quot;</span>, <span class="literal">null</span>, <span class="number">1</span>, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">myRow(<span class="number">0</span>) <span class="comment">// type Any</span></span><br><span class="line">myRow(<span class="number">0</span>).asInstanceOf[<span class="type">String</span>] <span class="comment">// String</span></span><br><span class="line">myRow.getString(<span class="number">0</span>) <span class="comment">// String</span></span><br><span class="line">myRow.getInt(<span class="number">2</span>) <span class="comment">// Int</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python ì‚¬ìš© ì‹œ</span></span><br><span class="line">myRow[<span class="number">0</span>]</span><br><span class="line">myRow[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="5-4-DataFrameì˜-íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜"><a href="#5-4-DataFrameì˜-íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜" class="headerlink" title="5.4 DataFrameì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜"></a>5.4 DataFrameì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜</h3><blockquote>
<p>DataFrameì„ ë‹¤ë£¨ëŠ” ë°©ë²• (ì£¼ìš” ì‘ì—… 4ê°€ì§€)</p>
<ul>
<li>ë¡œìš°ë‚˜ ì»¬ëŸ¼ ì¶”ê°€</li>
<li>ë¡œìš°ë‚˜ ì»¬ëŸ¼ ì œê±°</li>
<li>ë¡œìš°ë¥¼ ì»¬ëŸ¼ìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ê·¸ ë°˜ëŒ€ë¡œ ë³€í™˜</li>
<li>ì»¬ëŸ¼ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë¡œìš° ìˆœì„œ ë³€ê²½</li>
</ul>
<p>ëª¨ë“  ìœ í˜•ì˜ ì‘ì—…ì€ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥ (ex. ëª¨ë“  ë¡œìš°ì˜ íŠ¹ì • ì»¬ëŸ¼ê°’ ë³€ê²½ í›„ ê²°ê³¼ ë°˜í™˜)</p>
</blockquote>
<h4 id="1-DataFrame-ìƒì„±"><a href="#1-DataFrame-ìƒì„±" class="headerlink" title="(1) DataFrame ìƒì„±"></a>(1) DataFrame ìƒì„±</h4><details><summary class="point-color-can-hover">[5.4-1] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// A. ì›ì‹œ ë°ì´í„° ì†ŒìŠ¤ -&gt; DataFrame</span></span><br><span class="line"><span class="keyword">val</span> df = (spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>))</span><br><span class="line"><span class="comment">// (ì„ì‹œ ë·° ë“±ë¡)</span></span><br><span class="line">df.createOrReplaceTempView(<span class="string">&quot;dfTable&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// B. (Row ê°ì²´ë¥¼ ê°€ì§€ëŠ”) Seq íƒ€ì… -&gt; DataFrame</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">StructField</span>, <span class="type">StructType</span>, <span class="type">StringType</span>, <span class="type">LongType</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> myManualSchema = <span class="keyword">new</span> <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;some&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;col&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;names&quot;</span>, <span class="type">LongType</span>, <span class="literal">false</span>)))</span><br><span class="line"><span class="keyword">val</span> myRows = <span class="type">Seq</span>(<span class="type">Row</span>(<span class="string">&quot;Hello&quot;</span>, <span class="literal">null</span>, <span class="number">1</span>L))</span><br><span class="line"><span class="keyword">val</span> myRDD = spark.sparkContext.parallelize(myRows)</span><br><span class="line"><span class="keyword">val</span> myDf = spark.createDataFrame(myRDD, myManualSchema)</span><br><span class="line">myDf.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"><span class="comment">// | some| col|names|</span></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"><span class="comment">// |Hello|null|    1|</span></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Scala ì‚¬ìš© ì‹œ toDF() ì‚¬ìš© ê°€ëŠ¥ (import spark.implicits._)</span></span><br><span class="line"><span class="keyword">val</span> myDF = <span class="type">Seq</span>((<span class="string">&quot;Hello&quot;</span>, <span class="number">2</span>, <span class="number">1</span>L)).toDF(<span class="string">&quot;col1&quot;</span>, <span class="string">&quot;col2&quot;</span>, <span class="string">&quot;col3&quot;</span>)</span><br></pre></td></tr></table></figure>
</details>

<h4 id="2-select-ì™€-selectExpr"><a href="#2-select-ì™€-selectExpr" class="headerlink" title="(2) select ì™€ selectExpr"></a>(2) select ì™€ selectExpr</h4><details><summary class="point-color-can-hover">[5.4-2] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dataFrameTable</span><br><span class="line"><span class="keyword">SELECT</span> columnName <span class="keyword">FROM</span> dataFrameTable</span><br><span class="line"><span class="keyword">SELECT</span> columnName <span class="operator">*</span> <span class="number">10</span>, otherColumn, someOtherCol <span class="keyword">as</span> c <span class="keyword">FROM</span> dataFrameTable</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># select() == SELECT query</span></span><br><span class="line">scala&gt; df.select(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(2)</span><br><span class="line">+-----------------+</span><br><span class="line">|DEST_COUNTRY_NAME|</span><br><span class="line">+-----------------+</span><br><span class="line">|    United States|</span><br><span class="line">|    United States|</span><br><span class="line">+-----------------+</span><br><span class="line"></span><br><span class="line">scala&gt; df.select(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>, <span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>).show(2)</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line">|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line">|    United States|            Romania|</span><br><span class="line">|    United States|            Croatia|</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line"></span><br><span class="line">--- SQL</span><br><span class="line">SELECT DEST_COUNTRY_NAME FROM dfTable LIMIT 2</span><br><span class="line">SELECT DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME FROM dfTable LIMIT 2</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë‹¤ì–‘í•œ ì»¬ëŸ¼ ì°¸ì¡° ë°©ë²•</span></span><br><span class="line"><span class="comment">// df.select(col(&quot;DEST_COUNTRY_NAME&quot;), &quot;DEST_COUNTRY_NAME&quot;) =&gt; ì—ëŸ¬</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.&#123;expr, col, column&#125;</span><br><span class="line">(df.select(</span><br><span class="line">    df.col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">    col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">    column(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">    <span class="symbol">&#x27;DEST_COUNTRY_NAME</span>,</span><br><span class="line">    $<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>,</span><br><span class="line">    expr(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>))</span><br><span class="line">  .show(<span class="number">2</span>))</span><br><span class="line"><span class="comment">// +-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|</span></span><br><span class="line"><span class="comment">// +-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br><span class="line"><span class="comment">// |    United States|    United States|    United States|    United States|    United States|    United States|</span></span><br><span class="line"><span class="comment">// |    United States|    United States|    United States|    United States|    United States|    United States|</span></span><br><span class="line"><span class="comment">// +-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// expr() ì˜ˆì‹œ - ì»¬ëŸ¼ëª… DEST_COUNTRY_NAME -&gt; destination -&gt; DEST_COUNTRY_NAME</span></span><br><span class="line">df.select(expr(<span class="string">&quot;DEST_COUNTRY_NAME AS destination&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line">df.select(expr(<span class="string">&quot;DEST_COUNTRY_NAME as destination&quot;</span>).alias(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// select() + expr() =&gt; selectExpr()</span></span><br><span class="line">df.selectExpr(<span class="string">&quot;DEST_COUNTRY_NAME as newColumnName&quot;</span>, <span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"><span class="comment">// |newColumnName|DEST_COUNTRY_NAME|</span></span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"><span class="comment">// |United States|    United States|</span></span><br><span class="line"><span class="comment">// |United States|    United States|</span></span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"></span><br><span class="line">(df.selectExpr(</span><br><span class="line">    <span class="string">&quot;*&quot;</span>, <span class="comment">// include all original columns</span></span><br><span class="line">    <span class="string">&quot;(DEST_COUNTRY_NAME = ORIGIN_COUNTRY_NAME) as withinCountry&quot;</span>)</span><br><span class="line">  .show(<span class="number">2</span>))</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|withinCountry|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |    United States|            Romania|   15|        false|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|        false|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"></span><br><span class="line">df.selectExpr(<span class="string">&quot;avg(count)&quot;</span>, <span class="string">&quot;count(distinct(DEST_COUNTRY_NAME))&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br><span class="line"><span class="comment">// | avg(count)|count(DISTINCT DEST_COUNTRY_NAME)|</span></span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br><span class="line"><span class="comment">// |1770.765625|                              132|</span></span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br></pre></td></tr></table></figure>
</details>


<h4 id="3-ìŠ¤íŒŒí¬-ë°ì´í„°-íƒ€ì…ìœ¼ë¡œ-ë³€í™˜í•˜ê¸°"><a href="#3-ìŠ¤íŒŒí¬-ë°ì´í„°-íƒ€ì…ìœ¼ë¡œ-ë³€í™˜í•˜ê¸°" class="headerlink" title="(3) ìŠ¤íŒŒí¬ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê¸°"></a>(3) ìŠ¤íŒŒí¬ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-3] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="4-ì»¬ëŸ¼-ì¶”ê°€í•˜ê¸°"><a href="#4-ì»¬ëŸ¼-ì¶”ê°€í•˜ê¸°" class="headerlink" title="(4) ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°"></a>(4) ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-4] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="5-ì»¬ëŸ¼ëª…-ë³€ê²½í•˜ê¸°"><a href="#5-ì»¬ëŸ¼ëª…-ë³€ê²½í•˜ê¸°" class="headerlink" title="(5) ì»¬ëŸ¼ëª… ë³€ê²½í•˜ê¸°"></a>(5) ì»¬ëŸ¼ëª… ë³€ê²½í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-5] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="6-ì˜ˆì•½-ë¬¸ìì™€-í‚¤ì›Œë“œ"><a href="#6-ì˜ˆì•½-ë¬¸ìì™€-í‚¤ì›Œë“œ" class="headerlink" title="(6) ì˜ˆì•½ ë¬¸ìì™€ í‚¤ì›Œë“œ"></a>(6) ì˜ˆì•½ ë¬¸ìì™€ í‚¤ì›Œë“œ</h4><details><summary class="point-color-can-hover">[5.4-6] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="7-ëŒ€ì†Œë¬¸ì-êµ¬ë¶„"><a href="#7-ëŒ€ì†Œë¬¸ì-êµ¬ë¶„" class="headerlink" title="(7) ëŒ€ì†Œë¬¸ì êµ¬ë¶„"></a>(7) ëŒ€ì†Œë¬¸ì êµ¬ë¶„</h4><details><summary class="point-color-can-hover">[5.4-7] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="8-ì»¬ëŸ¼-ì œê±°í•˜ê¸°"><a href="#8-ì»¬ëŸ¼-ì œê±°í•˜ê¸°" class="headerlink" title="(8) ì»¬ëŸ¼ ì œê±°í•˜ê¸°"></a>(8) ì»¬ëŸ¼ ì œê±°í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-8] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="9-ì»¬ëŸ¼ì˜-ë°ì´í„°-íƒ€ì…-ë³€ê²½í•˜ê¸°"><a href="#9-ì»¬ëŸ¼ì˜-ë°ì´í„°-íƒ€ì…-ë³€ê²½í•˜ê¸°" class="headerlink" title="(9) ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°"></a>(9) ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-9] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="10-ë¡œìš°-í•„í„°ë§í•˜ê¸°"><a href="#10-ë¡œìš°-í•„í„°ë§í•˜ê¸°" class="headerlink" title="(10) ë¡œìš° í•„í„°ë§í•˜ê¸°"></a>(10) ë¡œìš° í•„í„°ë§í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-10] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="11-ê³ ìœ í•œ-ë¡œìš°-ì–»ê¸°"><a href="#11-ê³ ìœ í•œ-ë¡œìš°-ì–»ê¸°" class="headerlink" title="(11) ê³ ìœ í•œ ë¡œìš° ì–»ê¸°"></a>(11) ê³ ìœ í•œ ë¡œìš° ì–»ê¸°</h4><details><summary class="point-color-can-hover">[5.4-11] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="12-ë¬´ì‘ìœ„-ìƒ˜í”Œ-ë§Œë“¤ê¸°"><a href="#12-ë¬´ì‘ìœ„-ìƒ˜í”Œ-ë§Œë“¤ê¸°" class="headerlink" title="(12) ë¬´ì‘ìœ„ ìƒ˜í”Œ ë§Œë“¤ê¸°"></a>(12) ë¬´ì‘ìœ„ ìƒ˜í”Œ ë§Œë“¤ê¸°</h4><details><summary class="point-color-can-hover">[5.4-12] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="13-ì„ì˜-ë¶„í• í•˜ê¸°"><a href="#13-ì„ì˜-ë¶„í• í•˜ê¸°" class="headerlink" title="(13) ì„ì˜ ë¶„í• í•˜ê¸°"></a>(13) ì„ì˜ ë¶„í• í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-13] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="14-ë¡œìš°-í•©ì¹˜ê¸°ì™€-ì¶”ê°€í•˜ê¸°"><a href="#14-ë¡œìš°-í•©ì¹˜ê¸°ì™€-ì¶”ê°€í•˜ê¸°" class="headerlink" title="(14) ë¡œìš° í•©ì¹˜ê¸°ì™€ ì¶”ê°€í•˜ê¸°"></a>(14) ë¡œìš° í•©ì¹˜ê¸°ì™€ ì¶”ê°€í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-14] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="15-ë¡œìš°-ì •ë ¬í•˜ê¸°"><a href="#15-ë¡œìš°-ì •ë ¬í•˜ê¸°" class="headerlink" title="(15) ë¡œìš° ì •ë ¬í•˜ê¸°"></a>(15) ë¡œìš° ì •ë ¬í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-15] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="16-ë¡œìš°-ìˆ˜-ì œí•œí•˜ê¸°"><a href="#16-ë¡œìš°-ìˆ˜-ì œí•œí•˜ê¸°" class="headerlink" title="(16) ë¡œìš° ìˆ˜ ì œí•œí•˜ê¸°"></a>(16) ë¡œìš° ìˆ˜ ì œí•œí•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-16] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="17-repartitionê³¼-coalesce"><a href="#17-repartitionê³¼-coalesce" class="headerlink" title="(17) repartitionê³¼ coalesce"></a>(17) repartitionê³¼ coalesce</h4><details><summary class="point-color-can-hover">[5.4-17] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<h4 id="18-ë“œë¼ì´ë²„ë¡œ-ë¡œìš°-ë°ì´í„°-ìˆ˜ì§‘í•˜ê¸°"><a href="#18-ë“œë¼ì´ë²„ë¡œ-ë¡œìš°-ë°ì´í„°-ìˆ˜ì§‘í•˜ê¸°" class="headerlink" title="(18) ë“œë¼ì´ë²„ë¡œ ë¡œìš° ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°"></a>(18) ë“œë¼ì´ë²„ë¡œ ë¡œìš° ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-18] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>


<h3 id="5-5-ì •ë¦¬"><a href="#5-5-ì •ë¦¬" class="headerlink" title="5.5 ì •ë¦¬"></a>5.5 ì •ë¦¬</h3><ul>
<li>DataFrame ê¸°ë³¸ ì—°ì‚°</li>
<li>DataFrame ì‚¬ìš©ì— í•„ìš”í•œ ê°œë…, ë‹¤ì–‘í•œ ê¸°ëŠ¥</li>
</ul>
<h3 id="ğŸ“’-ë‹¨ì–´ì¥"><a href="#ğŸ“’-ë‹¨ì–´ì¥" class="headerlink" title="ğŸ“’ ë‹¨ì–´ì¥"></a>ğŸ“’ ë‹¨ì–´ì¥</h3><ul>
<li>ë¹„ê²°ì •ë¡ ì (nondeterministically) : = ë§¤ë²ˆ ë³€í•˜ëŠ”</li>
<li>ETL : <code>ì¶”ì¶œ(Extract)</code> - <code>ë³€í™˜(Transform)</code> - <code>ì ì¬(Load)</code>  <i style="color:lightgray">(ì¹œìˆ™í•˜ì¥¬?)</i></li>
</ul>
</div><p class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/study/">#study</a><a href="/tags/book/">#book</a><a href="/tags/spark/">#spark</a><a href="/tags/apache/">#apache</a></p></article></div><footer><div class="paginator"><a class="next" href="/2021/01/26/Spark-The-Definitive-Guide-4%EC%9E%A5/">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'minsw-github-io';
var disqus_identifier = '2021/01/26/Spark-The-Definitive-Guide-5ì¥/';
var disqus_title = '&amp;#039;Spark The Definitive Guide&amp;#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°';
var disqus_url = 'https://minsw.github.io/2021/01/26/Spark-The-Definitive-Guide-5ì¥/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>Â© 2018 - 2021 <a href="https://minsw.github.io">Lukka Min</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-143001954-1",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script></body></html>