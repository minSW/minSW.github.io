<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> &#039;Spark The Definitive Guide&#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚° Â· Look out</title><meta name="description" content="&amp;#039;Spark The Definitive Guide&amp;#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚° - Lukka Min"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/cover.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="search" type="application/opensearchdescription+xml" href="https://minsw.github.io/atom.xml" title="Look out"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/feed.xml" title="Look out" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/cover.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/tags/" target="_self">TAG</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/minSW" target="_blank">GITHUB</a></li></ul></header><main class="container"></main><div class="post"><article class="post-block"><h1 class="post-title">&#039;Spark The Definitive Guide&#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°</h1><div class="post-info">2021ë…„ 1ì›” 26ì¼<span class="categories"><i class="fa fa-bookmark" aria-hidden="true"></i></span><a class="post-category" href="/categories/spark/">#spark</a></div><div class="post-content"><br/>

<p>ì˜¤ëŠ˜ì˜ êµí›ˆ.<br>ë„ì»¤ ì´ë¯¸ì§€ì— ì˜ˆì œ ìˆë‹¤ê³  ì‹ ë‚˜ê²Œ ëŒë¦¬ê³ ~ ëŒë¦¬ê³ ~ í•˜ë‹¤ë³´ë©´<br>í„°ì§„ë‹¤ëŠ”ê±¸ ëª…ì‹¬í•˜ë„ë¡ í•˜ì ğŸ¥º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.io.IOException: No space left on device</span><br></pre></td></tr></table></figure>
<br/>

<img src="https://user-images.githubusercontent.com/26691216/106086744-1b72d100-6166-11eb-8d99-1deebfa68867.jpg" width="400" alt="jongman">
<center><i style="color:lightgray"> ì¸ìƒì€ ì‹¤ì „ì´ì•¼ ì¹œêµ¬ì•¼</i></center>

<img width="300" alt="bomb" src="https://user-images.githubusercontent.com/26691216/106087261-fcc10a00-6166-11eb-80c2-d339e59bbc99.png">



<center><h2>_ _ _</h2></center>

<br/>

<hr>
<h1 id="CHAPTER-5-êµ¬ì¡°ì -API-ê¸°ë³¸-ì—°ì‚°"><a href="#CHAPTER-5-êµ¬ì¡°ì -API-ê¸°ë³¸-ì—°ì‚°" class="headerlink" title="CHAPTER 5 êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°"></a>CHAPTER 5 êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°</h1><p>CHAPTER 4 ëŠ” êµ¬ì¡°ì  APIì˜ í•µì‹¬ ì¶”ìƒí™” â€˜ê°œë…â€™ì„ ì†Œê°œ<br>CHAPTER 5 ëŠ” DataFrameê³¼ ê·¸ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ë³¸ â€˜ê¸°ëŠ¥â€™ ì†Œê°œ</p>
<blockquote>
<p><em>â€˜DataFrame = Row íƒ€ì…ì˜ <strong>ë ˆì½”ë“œ</strong> + ì—¬ëŸ¬ <strong>ì»¬ëŸ¼</strong>â€˜</em><br>(ê° ì»¬ëŸ¼ëª…ê³¼ ë°ì´í„° íƒ€ì…ì€ <strong>ìŠ¤í‚¤ë§ˆ</strong>ë¡œ ì •ì˜)</p>
<p>DataFrameì˜ <strong>íŒŒí‹°ì…”ë‹</strong> :  DataFrame (ë˜ëŠ” Dataset)ì´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë¬¼ë¦¬ì ìœ¼ë¡œ ë°°ì¹˜ë˜ëŠ” í˜•íƒœë¥¼ ì •ì˜</p>
<ul>
<li><strong>íŒŒí‹°ì…”ë‹ ìŠ¤í‚¤ë§ˆ</strong> : íŒŒí‹°ì…˜ì„ ë°°ì¹˜í•˜ëŠ” ë°©ë²• ì •ì˜</li>
<li>íŒŒí‹°ì…”ë‹ì˜ ë¶„í•  ê¸°ì¤€? =&gt; íŠ¹ì • ì»¬ëŸ¼ or ë¹„ê²°ì •ë¡ ì (nondeterministically) ê°’ ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •</li>
</ul>
</blockquote>
<h3 id="5-1-ìŠ¤í‚¤ë§ˆ"><a href="#5-1-ìŠ¤í‚¤ë§ˆ" class="headerlink" title="5.1 ìŠ¤í‚¤ë§ˆ"></a>5.1 ìŠ¤í‚¤ë§ˆ</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> df = spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>)</span><br><span class="line">df.printSchema()</span><br><span class="line"></span><br><span class="line"><span class="comment">// root</span></span><br><span class="line"><span class="comment">//  |-- DEST_COUNTRY_NAME: string (nullable = true)</span></span><br><span class="line"><span class="comment">//  |-- ORIGIN_COUNTRY_NAME: string (nullable = true)</span></span><br><span class="line"><span class="comment">//  |-- count: long (nullable = true)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ìŠ¤í‚¤ë§ˆëŠ” <strong>DataFrameì˜ ì»¬ëŸ¼ëª…ê³¼ ë°ì´í„° íƒ€ì…ì„ ì •ì˜</strong></p>
<ul>
<li>ê´€ë ¨ëœ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ì—­í• </li>
</ul>
</li>
<li><p>ë°ì´í„° ì†ŒìŠ¤ì—ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ì–»ê±°ë‚˜ (Schema-on-read), ì§ì ‘ ì •ì˜ ê°€ëŠ¥</p>
<ul>
<li>ëŒ€ë¶€ë¶„ì˜ ë¹„ì •í˜• ë¶„ì„ (ad-hoc analysis)ì—ì„œ schema-on-read ì˜ ë™ì‘</li>
<li>ìš´ì˜ í™˜ê²½ ETL ì‘ì—…ì— ìŠ¤íŒŒí¬ ì‚¬ìš©ì‹œ <strong>ì§ì ‘ ì •ì˜ í•„ìš”</strong> (ìƒ˜í”Œ ë°ì´í„° íƒ€ì…ì— ë”°ë¥¸ ìŠ¤í‚¤ë§ˆ ì¶”ë¡  ë°©ì§€)</li>
</ul>
</li>
<li><p>ìŠ¤í‚¤ë§ˆëŠ” <code>StructType</code> ê°ì²´ </p>
<ul>
<li><p>ë³µí•© ë°ì´í„° íƒ€ì… <code>StructType</code> (=consistOf(<code>StructField</code> ê°ì²´))</p>
</li>
<li><p>ìŠ¤íŒŒí¬ëŠ” ìì²´ ë°ì´í„° íƒ€ì… ì •ë³´ë¥¼ ì‚¬ìš© =&gt; ì–¸ì–´ ë³„ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì„¤ì • X</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>).schema</span><br><span class="line"><span class="comment">// res176: org.apache.spark.sql.types.StructType</span></span><br><span class="line"><span class="comment">//  = StructType(</span></span><br><span class="line"><span class="comment">//        StructField(DEST_COUNTRY_NAME,StringType,true),</span></span><br><span class="line"><span class="comment">//        StructField(ORIGIN_COUNTRY_NAME,StringType,true),</span></span><br><span class="line"><span class="comment">//        StructField(count,LongType,true)</span></span><br><span class="line"><span class="comment">//      )</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<details><summary class="point-color-can-hover">[5.1] ì˜ˆì œ í¼ì¹˜ê¸° - DataFrameì— ìŠ¤í‚¤ë§ˆ ì ìš© ì˜ˆì œ</summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataFrameì— ìŠ¤í‚¤ë§ˆë¥¼ ë§Œë“¤ê³  ì ìš©í•˜ëŠ” ì˜ˆì œ</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">StructField</span>, <span class="type">StructType</span>, <span class="type">StringType</span>, <span class="type">LongType</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.<span class="type">Metadata</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> myManualSchema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;count&quot;</span>, <span class="type">LongType</span>, <span class="literal">false</span>,</span><br><span class="line">    <span class="type">Metadata</span>.fromJson(<span class="string">&quot;&#123;\&quot;hello\&quot;:\&quot;world\&quot;&#125;&quot;</span>))</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> df = (spark.read.format(<span class="string">&quot;json&quot;</span>).schema(myManualSchema)</span><br><span class="line">  .load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>))</span><br></pre></td></tr></table></figure>
</details>


<h3 id="5-2-ì»¬ëŸ¼ê³¼-í‘œí˜„ì‹"><a href="#5-2-ì»¬ëŸ¼ê³¼-í‘œí˜„ì‹" class="headerlink" title="5.2 ì»¬ëŸ¼ê³¼ í‘œí˜„ì‹"></a>5.2 ì»¬ëŸ¼ê³¼ í‘œí˜„ì‹</h3><ul>
<li><p>ìŠ¤íŒŒí¬ì˜ â€˜ì»¬ëŸ¼â€™ (=í‘œí˜„ì‹)</p>
<ul>
<li>ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸, Rì˜ dataframe, Pandasì˜ ì»¬ëŸ¼ê³¼ ë¹„ìŠ·</li>
<li>ì‚¬ìš©ìëŠ” <u><strong>í‘œí˜„ì‹</strong></u>ìœ¼ë¡œ DataFrameì˜ ì»¬ëŸ¼ì„ ì„ íƒ, ì¡°ì‘, ì œê±° ê°€ëŠ¥</li>
<li>ì¦‰ í‘œí˜„ì‹ì„ ì‚¬ìš©í•´ ë ˆì½”ë“œ ë‹¨ìœ„ë¡œ ê³„ì‚°í•œ ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” ë…¼ë¦¬ì  êµ¬ì¡°. ì‹¤ì œê°’ì„ ì–»ìœ¼ë ¤ë©´ ë¡œìš° (=&gt; DataFrame) ê°€ í•„ìš”</li>
<li>ì™¸ë¶€ ì ‘ê·¼ì‹œ <strong>ë°˜ë“œì‹œ DataFrame ì„ í†µí•´ì•¼ í•¨</strong></li>
</ul>
</li>
<li><p>ì»¬ëŸ¼ ìƒì„± &amp; ì°¸ì¡° : <code>col()</code> <code>column()</code></p>
<ul>
<li>ì»¬ëŸ¼ì´ DataFrameì— ìˆëŠ”ì§€ ì—†ëŠ”ì§€ëŠ” ëª¨ë¦„ =&gt; <strong>ë¶„ì„ê¸°</strong>ê°€ <strong>ì¹´íƒˆë¡œê·¸</strong>ì— ì €ì¥ëœ ì •ë³´ë‘ ë¹„êµí•˜ê¸° ì „ê¹Œì§€ëŠ” ë¯¸í™•ì¸ <a href="https://minsw.github.io/2021/01/26/Spark-The-Definitive-Guide-4%EC%9E%A5/#4-4-%EA%B5%AC%EC%A1%B0%EC%A0%81-API%EC%9D%98-%EC%8B%A4%ED%96%89-%EA%B3%BC%EC%A0%95">[4.4] ì°¸ê³ </a></li>
<li>ìŠ¤ì¹¼ë¼ëŠ” ê³ ìœ  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ : <code>$&quot;ì»¬ëŸ¼ëª…&quot;</code> <code>&#39;ì»¬ëŸ¼ëª…</code> (<code>&#39;</code> : í‹± ë§ˆí¬, ì‹¬ë²Œ)</li>
<li>ëª…ì‹œì  ì°¸ì¡° : <code>DataFrame.col()</code> (ì¡°ì¸ì‹œ ìœ ìš©)<br>=&gt; ëª…ì‹œì  ì»¬ëŸ¼ ì •ì˜ ì‹œ, ë¶„ì„ê¸° ì‹¤í–‰ ë‹¨ê³„ì—ì„œ ì»¬ëŸ¼ í™•ì¸ ì ˆì°¨ ìƒëµ</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.&#123;col, column&#125;</span><br><span class="line">col(<span class="string">&quot;someCol&quot;</span>)</span><br><span class="line">column(<span class="string">&quot;someCol&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Scala</span></span><br><span class="line">$<span class="string">&quot;someCol&quot;</span></span><br><span class="line"><span class="symbol">&#x27;someCol</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ëª…ì‹œì  ì°¸ì¡°</span></span><br><span class="line">df.col(<span class="string">&quot;someCol&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p><strong>í‘œí˜„ì‹</strong> : <code>expr()</code></p>
<ul>
<li>DataFrame ë ˆì½”ë“œì˜ ì—¬ëŸ¬ ê°’ì— ëŒ€í•œ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ì§‘í•©</li>
<li>ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ì…ë ¥ë°›ì•„ ì‹ë³„ -&gt; ë‹¤ì–‘í•œ í‘œí˜„ì‹ì„ ê° ë ˆì½”ë“œì— ì ìš© -&gt; <strong>â€˜ë‹¨ì¼ê°’â€™</strong> (ë³µí•© ë°ì´í„° íƒ€ì…) ìœ¼ë¡œ ì¶œë ¥ í•˜ëŠ” í•¨ìˆ˜</li>
<li><em>DataFrameì˜ ì»¬ëŸ¼ì€ â€˜í‘œí˜„ì‹â€™ì´ë‹¤</em><ul>
<li><code>expr(&quot;someCol&quot;)</code> == <code>col(&quot;someCol&quot;)</code> (ë™ì¼ ë™ì‘)</li>
<li>ì»¬ëŸ¼ì€ í‘œí˜„ì‹ì˜ ì¼ë¶€ ê¸°ëŠ¥ ì œê³µ</li>
</ul>
</li>
</ul>
</li>
<li><p>ìŠ¤íŒŒí¬ëŠ” ì—°ì‚° ìˆœì„œë¥¼ ì§€ì •í•˜ëŠ” ë…¼ë¦¬ì  íŠ¸ë¦¬ë¡œ ì»´íŒŒì¼</p>
<ul>
<li>DataFrame ì½”ë“œë‚˜ SQL í‘œí˜„ì‹ ì‘ì„± ì‹œ, ì‹¤í–‰ ì‹œì ì— ë™ì¼í•œ ë…¼ë¦¬ íŠ¸ë¦¬ë¡œ ì»´íŒŒì¼ ë˜ë¯€ë¡œ ë™ì¼í•œ ì„±ëŠ¥ ë°œíœ˜</li>
<li>ì˜ˆì‹œëŠ” <code>p.129</code> [ê·¸ë¦¼ 5-1] ë…¼ë¦¬ì  íŠ¸ë¦¬ DAG ì°¸ê³ </li>
<li><code>expr(&quot;someCol - 5&quot;)</code> == <code>col(&quot;someCol&quot;) - 5</code> == <code>expr(&quot;someCol&quot;) - 5</code>  (ë‹¤ ê°™ì€ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ê³¼ì •)</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë™ì¼í•œ í‘œí˜„ - col(), expr()</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.expr</span><br><span class="line">expr(<span class="string">&quot;(((someCol + 5) * 200) - 6) &lt; otherCol&quot;</span>)</span><br><span class="line"></span><br><span class="line">(((col(<span class="string">&quot;someCol&quot;</span>) + <span class="number">5</span>) * <span class="number">200</span>) - <span class="number">6</span>) &lt; col(<span class="string">&quot;otherCol&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataFrame ì»¬ëŸ¼ ì ‘ê·¼ (printScheme() ì•„ë‹Œ í”„ë¡œê·¸ë˜ë° ë°©ì‹)</span></span><br><span class="line">spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>).columns</span><br><span class="line"><span class="comment">// res0: Array[String] = Array(DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count)</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>â€˜í‘œí˜„ì‹â€™ ê³¼ â€˜ì»¬ëŸ¼â€™ ì‚¬ì´ í•µì‹¬ ë‚´ìš©</p>
<ul>
<li>ì»¬ëŸ¼ì€ ë‹¨ì§€ í‘œí˜„ì‹ì¼ ë¿</li>
<li>ì»¬ëŸ¼ê³¼ ì»¬ëŸ¼ì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ì€ íŒŒì‹±ëœ í‘œí˜„ì‹ê³¼ ë™ì¼í•œ ë…¼ë¦¬ì  ì‹¤í–‰ ê³„íšìœ¼ë¡œ ì»´íŒŒì¼</li>
</ul>
</blockquote>
<h3 id="5-3-ë ˆì½”ë“œì™€-ë¡œìš°"><a href="#5-3-ë ˆì½”ë“œì™€-ë¡œìš°" class="headerlink" title="5.3 ë ˆì½”ë“œì™€ ë¡œìš°"></a>5.3 ë ˆì½”ë“œì™€ ë¡œìš°</h3><ul>
<li>ìŠ¤íŒŒí¬ì˜ â€˜ë¡œìš°â€™ (=ë ˆì½”ë“œ)<ul>
<li>ìŠ¤íŒŒí¬ì—ì„œ DataFrameì˜ ê° ë¡œìš°ëŠ” í•˜ë‚˜ì˜ ë ˆì½”ë“œ</li>
<li>ê°’ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì»¬ëŸ¼ í‘œí˜„ì‹ìœ¼ë¡œ Row ê°ì²´ë¥¼ ë‹¤ë£¸</li>
<li>Row ê°ì²´ëŠ” ë‚´ë¶€ ë°”ì´íŠ¸ ë°°ì—´ì„ ê°€ì§€ëŠ” ì¸í„°í˜ì´ìŠ¤ =&gt; <strong>ì˜¤ì§ ì»¬ëŸ¼ í‘œí˜„ì‹ìœ¼ë¡œë§Œ</strong> ë‹¤ë£° ìˆ˜ ìˆìŒ (ì™¸ë¶€ ë…¸ì¶œ X)<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Row í™•ì¸</span></span><br><span class="line">scala&gt; df.first()</span><br><span class="line"><span class="comment">// res1: org.apache.spark.sql.Row = [United States,Romania,15]</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>ë¡œìš° ìƒì„±<ul>
<li>ê° ì»¬ëŸ¼ì— í•´ë‹¹í•˜ëŠ” ê°’ìœ¼ë¡œ ì§ì ‘ Row ê°ì²´ ìƒì„± ê°€ëŠ¥</li>
<li>ê·¸ëŸ¬ë‚˜ Row ê°ì²´ëŠ” ìŠ¤í‚¤ë§ˆ ì •ë³´ X (=&gt; ì˜¤ì§ DataFrameë§Œ ê°€ì§)</li>
<li>=&gt; ìŠ¤í‚¤ë§ˆë‘ ê°™ì€ ìˆœì„œë¡œ ê°’ ëª…ì‹œí•´ì•¼í•¨</li>
</ul>
</li>
<li>ë¡œìš° ë°ì´í„° ì ‘ê·¼í•˜ë ¤ë©´ =&gt; ì›í•˜ëŠ” ìœ„ì¹˜ ì§€ì •<ul>
<li>Python, R ì€ ì˜¬ë°”ë¥¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì•Œì•„ì„œ ë³€í™˜ë¨</li>
<li>Scala, Java ëŠ” í—¬í¼ ë©”ì„œë“œë‚˜ ë°ì´í„°íƒ€ì… ëª…ì‹œì  ì§€ì • í•„ìš” (Dataset API ì‚¬ìš© ì‹œ jvm ê°ì²´ ë°ì´í„° ì…‹ ì–»ì„ ìˆ˜ ìˆìŒ)<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"><span class="keyword">val</span> myRow = <span class="type">Row</span>(<span class="string">&quot;Hello&quot;</span>, <span class="literal">null</span>, <span class="number">1</span>, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">myRow(<span class="number">0</span>) <span class="comment">// type Any</span></span><br><span class="line">myRow(<span class="number">0</span>).asInstanceOf[<span class="type">String</span>] <span class="comment">// String</span></span><br><span class="line">myRow.getString(<span class="number">0</span>) <span class="comment">// String</span></span><br><span class="line">myRow.getInt(<span class="number">2</span>) <span class="comment">// Int</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python ì‚¬ìš© ì‹œ</span></span><br><span class="line">myRow[<span class="number">0</span>]</span><br><span class="line">myRow[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="5-4-DataFrameì˜-íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜"><a href="#5-4-DataFrameì˜-íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜" class="headerlink" title="5.4 DataFrameì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜"></a>5.4 DataFrameì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜</h3><blockquote>
<p>DataFrameì„ ë‹¤ë£¨ëŠ” ë°©ë²• (ì£¼ìš” ì‘ì—… 4ê°€ì§€)</p>
<ul>
<li>ë¡œìš°ë‚˜ ì»¬ëŸ¼ ì¶”ê°€</li>
<li>ë¡œìš°ë‚˜ ì»¬ëŸ¼ ì œê±°</li>
<li>ë¡œìš°ë¥¼ ì»¬ëŸ¼ìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ê·¸ ë°˜ëŒ€ë¡œ ë³€í™˜</li>
<li>ì»¬ëŸ¼ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë¡œìš° ìˆœì„œ ë³€ê²½</li>
</ul>
<p>ëª¨ë“  ìœ í˜•ì˜ ì‘ì—…ì€ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥ (ex. ëª¨ë“  ë¡œìš°ì˜ íŠ¹ì • ì»¬ëŸ¼ê°’ ë³€ê²½ í›„ ê²°ê³¼ ë°˜í™˜)</p>
</blockquote>
<ul>
<li><a href="#1-DataFrame-%EC%83%9D%EC%84%B1">(1) DataFrame ìƒì„±</a></li>
<li><a href="#2-select-%EC%99%80-selectExpr">(2) select ì™€ selectExpr</a></li>
<li><a href="#3-%EC%8A%A4%ED%8C%8C%ED%81%AC-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85%EC%9C%BC%EB%A1%9C-%EB%B3%80%ED%99%98%ED%95%98%EA%B8%B0">(3) ìŠ¤íŒŒí¬ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê¸°</a></li>
<li><a href="#4-%EC%BB%AC%EB%9F%BC-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0">(4) ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°</a></li>
<li><a href="#5-%EC%BB%AC%EB%9F%BC%EB%AA%85-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0">(5) ì»¬ëŸ¼ëª… ë³€ê²½í•˜ê¸°</a></li>
<li><a href="#6-%EC%98%88%EC%95%BD-%EB%AC%B8%EC%9E%90%EC%99%80-%ED%82%A4%EC%9B%8C%EB%93%9C">(6) ì˜ˆì•½ ë¬¸ìì™€ í‚¤ì›Œë“œ</a></li>
<li><a href="#7-%EB%8C%80%EC%86%8C%EB%AC%B8%EC%9E%90-%EA%B5%AC%EB%B6%84">(7) ëŒ€ì†Œë¬¸ì êµ¬ë¶„</a></li>
<li><a href="#8-%EC%BB%AC%EB%9F%BC-%EC%A0%9C%EA%B1%B0%ED%95%98%EA%B8%B0">(8) ì»¬ëŸ¼ ì œê±°í•˜ê¸°</a></li>
<li><a href="#9-%EC%BB%AC%EB%9F%BC%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0">(9) ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°</a></li>
<li><a href="#10-%EB%A1%9C%EC%9A%B0-%ED%95%84%ED%84%B0%EB%A7%81%ED%95%98%EA%B8%B0">(10) ë¡œìš° í•„í„°ë§í•˜ê¸°</a></li>
<li><a href="#11-%EA%B3%A0%EC%9C%A0%ED%95%9C-%EB%A1%9C%EC%9A%B0-%EC%96%BB%EA%B8%B0">(11) ê³ ìœ í•œ ë¡œìš° ì–»ê¸°</a></li>
<li><a href="#12-%EB%AC%B4%EC%9E%91%EC%9C%84-%EC%83%98%ED%94%8C-%EB%A7%8C%EB%93%A4%EA%B8%B0">(12) ë¬´ì‘ìœ„ ìƒ˜í”Œ ë§Œë“¤ê¸°</a></li>
<li><a href="#13-%EC%9E%84%EC%9D%98-%EB%B6%84%ED%95%A0%ED%95%98%EA%B8%B0">(13) ì„ì˜ ë¶„í• í•˜ê¸°</a></li>
<li><a href="#14-%EB%A1%9C%EC%9A%B0-%ED%95%A9%EC%B9%98%EA%B8%B0%EC%99%80-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0">(14) ë¡œìš° í•©ì¹˜ê¸°ì™€ ì¶”ê°€í•˜ê¸°</a></li>
<li><a href="#15-%EB%A1%9C%EC%9A%B0-%EC%A0%95%EB%A0%AC%ED%95%98%EA%B8%B0">(15) ë¡œìš° ì •ë ¬í•˜ê¸°</a></li>
<li><a href="#16-%EB%A1%9C%EC%9A%B0-%EC%88%98-%EC%A0%9C%ED%95%9C%ED%95%98%EA%B8%B0">(16) ë¡œìš° ìˆ˜ ì œí•œí•˜ê¸°</a></li>
<li><a href="#17-repartition%EA%B3%BC-coalesce">(17) repartitionê³¼ coalesce</a></li>
<li><a href="#18-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84%EB%A1%9C-%EB%A1%9C%EC%9A%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%88%98%EC%A7%91%ED%95%98%EA%B8%B0">(18) ë“œë¼ì´ë²„ë¡œ ë¡œìš° ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°</a></li>
</ul>
<br/>

<h4 id="1-DataFrame-ìƒì„±"><a href="#1-DataFrame-ìƒì„±" class="headerlink" title="(1) DataFrame ìƒì„±"></a>(1) DataFrame ìƒì„±</h4><details><summary class="point-color-can-hover">[5.4-1] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// A. ì›ì‹œ ë°ì´í„° ì†ŒìŠ¤ -&gt; DataFrame</span></span><br><span class="line"><span class="keyword">val</span> df = (spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/2015-summary.json&quot;</span>))</span><br><span class="line"><span class="comment">// (ì„ì‹œ ë·° ë“±ë¡)</span></span><br><span class="line">df.createOrReplaceTempView(<span class="string">&quot;dfTable&quot;</span>)</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line"><span class="comment">// B. (Row ê°ì²´ë¥¼ ê°€ì§€ëŠ”) Seq íƒ€ì… -&gt; DataFrame</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">StructField</span>, <span class="type">StructType</span>, <span class="type">StringType</span>, <span class="type">LongType</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> myManualSchema = <span class="keyword">new</span> <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;some&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;col&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="type">StructField</span>(<span class="string">&quot;names&quot;</span>, <span class="type">LongType</span>, <span class="literal">false</span>)))</span><br><span class="line"><span class="keyword">val</span> myRows = <span class="type">Seq</span>(<span class="type">Row</span>(<span class="string">&quot;Hello&quot;</span>, <span class="literal">null</span>, <span class="number">1</span>L))</span><br><span class="line"><span class="comment">// sc ê°ì²´ì˜ parallelize() ë¡œ RDD ìƒì„±</span></span><br><span class="line"><span class="keyword">val</span> myRDD = spark.sparkContext.parallelize(myRows)</span><br><span class="line"><span class="comment">// createDataFrame()ë¡œ DataFrame ìƒì„±</span></span><br><span class="line"><span class="keyword">val</span> myDf = spark.createDataFrame(myRDD, myManualSchema)</span><br><span class="line">myDf.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"><span class="comment">// | some| col|names|</span></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"><span class="comment">// |Hello|null|    1|</span></span><br><span class="line"><span class="comment">// +-----+----+-----+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Scala ì‚¬ìš© ì‹œ toDF() ì‚¬ìš© ê°€ëŠ¥ (import spark.implicits._)</span></span><br><span class="line"><span class="keyword">val</span> myDF = <span class="type">Seq</span>((<span class="string">&quot;Hello&quot;</span>, <span class="number">2</span>, <span class="number">1</span>L)).toDF(<span class="string">&quot;col1&quot;</span>, <span class="string">&quot;col2&quot;</span>, <span class="string">&quot;col3&quot;</span>)</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>ìŠ¤íŒŒí¬ì˜ implicits (import í•„ìš”, <a target="_blank" rel="noopener" href="http://bit.ly/2xrFpML">ì°¸ê³ </a>)<ul>
<li>Scala ìŠ¤íŒŒí¬ ì½˜ì†” ì‚¬ìš© ì‹œ =&gt; Seq ë°ì´í„° íƒ€ì…ì— <code>toDF()</code> ì‚¬ìš© ê°€ëŠ¥</li>
<li>ê·¸ëŸ¬ë‚˜ null íƒ€ì…ê³¼ëŠ” ì•ˆë§ìœ¼ë¯€ë¡œ ìš´ì˜í™˜ê²½ ì‚¬ìš©ì€ ê¶Œì¥ X</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="createDataFrame-vs-toDF"><a href="#createDataFrame-vs-toDF" class="headerlink" title="createDataFrame() vs toDF()"></a>createDataFrame() vs toDF()</h4><ul>
<li><code>createDataFrame(rowRDD: RDD[Row], schema: StructType) : DataFrame</code><ul>
<li>ëª¨ë“  schema customization ê°€ëŠ¥</li>
<li><a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/SparkSession.html#createDataFrame(rowRDD:org.apache.spark.rdd.RDD[org.apache.spark.sql.Row],schema:org.apache.spark.sql.types.StructType):org.apache.spark.sql.DataFrame">API docs#SparkSession</a></li>
</ul>
</li>
<li><code>toDF()</code><ul>
<li>ìŠ¤í‚¤ë§ˆ ì§€ì • ì—†ìŒ. schema ì¶”ë¡  (Dataset API)</li>
<li><code>import spark.implicits._</code> í•„ìš”</li>
<li><a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/Dataset.html#toDF():org.apache.spark.sql.DataFrame">API docs#Dataset</a></li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="2-select-ì™€-selectExpr"><a href="#2-select-ì™€-selectExpr" class="headerlink" title="(2) select ì™€ selectExpr"></a>(2) select ì™€ selectExpr</h4><details><summary class="point-color-can-hover">[5.4-2] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dataFrameTable</span><br><span class="line"><span class="keyword">SELECT</span> columnName <span class="keyword">FROM</span> dataFrameTable</span><br><span class="line"><span class="keyword">SELECT</span> columnName <span class="operator">*</span> <span class="number">10</span>, otherColumn, someOtherCol <span class="keyword">as</span> c <span class="keyword">FROM</span> dataFrameTable</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># select() == SELECT query</span></span><br><span class="line">scala&gt; df.select(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(2)</span><br><span class="line">+-----------------+</span><br><span class="line">|DEST_COUNTRY_NAME|</span><br><span class="line">+-----------------+</span><br><span class="line">|    United States|</span><br><span class="line">|    United States|</span><br><span class="line">+-----------------+</span><br><span class="line"></span><br><span class="line">scala&gt; df.select(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>, <span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>).show(2)</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line">|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line">|    United States|            Romania|</span><br><span class="line">|    United States|            Croatia|</span><br><span class="line">+-----------------+-------------------+</span><br><span class="line"></span><br><span class="line">--- SQL</span><br><span class="line">SELECT DEST_COUNTRY_NAME FROM dfTable LIMIT 2</span><br><span class="line">SELECT DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME FROM dfTable LIMIT 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ë‹¤ì–‘í•œ ì»¬ëŸ¼ ì°¸ì¡° ë°©ë²•</span></span><br><span class="line"><span class="comment"># df.select(col(&quot;DEST_COUNTRY_NAME&quot;), &quot;DEST_COUNTRY_NAME&quot;) =&gt; ì—ëŸ¬</span></span><br><span class="line">scala&gt; import org.apache.spark.sql.functions.&#123;expr, col, column&#125;</span><br><span class="line">scala&gt; (df.select(</span><br><span class="line">     |     df.col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">     |     col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">     |     column(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>),</span><br><span class="line">     |     <span class="string">&#x27;DEST_COUNTRY_NAME,</span></span><br><span class="line"><span class="string">     |     $&quot;DEST_COUNTRY_NAME&quot;,</span></span><br><span class="line"><span class="string">     |     expr(&quot;DEST_COUNTRY_NAME&quot;))</span></span><br><span class="line"><span class="string">     |   .show(2))</span></span><br><span class="line"><span class="string">+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br><span class="line"><span class="string">|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|</span></span><br><span class="line"><span class="string">+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br><span class="line"><span class="string">|    United States|    United States|    United States|    United States|    United States|    United States|</span></span><br><span class="line"><span class="string">|    United States|    United States|    United States|    United States|    United States|    United States|</span></span><br><span class="line"><span class="string">+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// expr() ì˜ˆì‹œ - ì»¬ëŸ¼ëª… DEST_COUNTRY_NAME -&gt; destination -&gt; DEST_COUNTRY_NAME</span></span><br><span class="line">df.select(expr(<span class="string">&quot;DEST_COUNTRY_NAME AS destination&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line">df.select(expr(<span class="string">&quot;DEST_COUNTRY_NAME as destination&quot;</span>).alias(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// select() + expr() =&gt; selectExpr()</span></span><br><span class="line">df.selectExpr(<span class="string">&quot;DEST_COUNTRY_NAME as newColumnName&quot;</span>, <span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"><span class="comment">// |newColumnName|DEST_COUNTRY_NAME|</span></span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"><span class="comment">// |United States|    United States|</span></span><br><span class="line"><span class="comment">// |United States|    United States|</span></span><br><span class="line"><span class="comment">// +-------------+-----------------+</span></span><br><span class="line"></span><br><span class="line">(df.selectExpr(</span><br><span class="line">    <span class="string">&quot;*&quot;</span>, <span class="comment">// include all original columns</span></span><br><span class="line">    <span class="string">&quot;(DEST_COUNTRY_NAME = ORIGIN_COUNTRY_NAME) as withinCountry&quot;</span>)</span><br><span class="line">  .show(<span class="number">2</span>))</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|withinCountry|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |    United States|            Romania|   15|        false|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|        false|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"></span><br><span class="line">df.selectExpr(<span class="string">&quot;avg(count)&quot;</span>, <span class="string">&quot;count(distinct(DEST_COUNTRY_NAME))&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br><span class="line"><span class="comment">// | avg(count)|count(DISTINCT DEST_COUNTRY_NAME)|</span></span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br><span class="line"><span class="comment">// |1770.765625|                              132|</span></span><br><span class="line"><span class="comment">// +-----------+---------------------------------+</span></span><br></pre></td></tr></table></figure>
</details>


<blockquote>
<p>DataFrameì„ ë‹¤ë£¨ê¸° ìœ„í•œ ëŒ€ë¶€ë¶„ì˜ íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ì‘ì—… í•´ê²° ê°€ëŠ¥</p>
<ul>
<li><code>select()</code> : ì»¬ëŸ¼ì´ë‚˜ í‘œí˜„ì‹ì„ ì‚¬ìš©</li>
<li><code>selectExpr()</code> : ë¬¸ìì—´ í‘œí˜„ì‹ì„ ì‚¬ìš©</li>
<li><code>select()</code>: ë©”ì„œë“œë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” <code>org.apache.spark.sql.function</code> ì— í¬í•¨ëœ ë‹¤ì–‘í•œ í•¨ìˆ˜</li>
</ul>
</blockquote>
<ul>
<li>DataFrame ì»¬ëŸ¼ ë‹¤ë£° ì‹œ, SQL ì‚¬ìš© ê°€ëŠ¥</li>
<li>ì»¬ëŸ¼ ì°¸ì¡° ë°©ë²•ì€ ë‹¤ì–‘í•œ ë°©ë²•ì„ ì„ì–´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 5.2 ì¬ì°¸ê³ <ul>
<li>Column ê°ì²´ë‘ ë¬¸ìì—´ì„ í•¨ê»˜ ì„ì–´ì“¸ìˆ˜ëŠ” X (ex. <code>df.select(col(&quot;DEST_COUNTRY_NAME&quot;), &quot;DEST_COUNTRY_NAME&quot;)</code> =&gt; ì»´íŒŒì¼ ì—ëŸ¬)</li>
<li>ê°€ì¥ ìœ ì—°í•œ ì°¸ì¡° ë°©ë²• =&gt; <code>expr()</code></li>
</ul>
</li>
<li><code>select()</code> + <code>expr()</code> íŒ¨í„´ì„ ìì£¼ ì‚¬ìš© =&gt; <strong><code>selectExpr()</code></strong> (íš¨ìœ¨ì„± â†‘)<ul>
<li><i style="color:gray">â€œ?? : í¬í­..ìŠ¤íŒŒí¬ì˜ ì§„ì •í•œ ëŠ¥ë ¥ì„ ë³´ì—¬ì£¼ì§€..â€</i></li>
<li>ìƒˆë¡œìš´ DataFrame ìƒì„±í•˜ëŠ” ë³µì¡í•œ í‘œí˜„ì‹ ê°„ë‹¨í•˜ê²Œ í‘œí˜„ ê°€ëŠ¥</li>
<li>ëª¨ë“  ìœ íš¨í•œ ë¹„ì§‘ê³„í˜• (non-aggregating) SQL ì§€ì • ê°€ëŠ¥ (ë‹¨, ì»¬ëŸ¼ ì‹ë³„ ê°€ëŠ¥í•´ì•¼)</li>
<li>ì§‘ê³„ í•¨ìˆ˜ (avg, count ë“±) ì‚¬ìš© ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<h4 id="3-ìŠ¤íŒŒí¬-ë°ì´í„°-íƒ€ì…ìœ¼ë¡œ-ë³€í™˜í•˜ê¸°"><a href="#3-ìŠ¤íŒŒí¬-ë°ì´í„°-íƒ€ì…ìœ¼ë¡œ-ë³€í™˜í•˜ê¸°" class="headerlink" title="(3) ìŠ¤íŒŒí¬ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê¸°"></a>(3) ìŠ¤íŒŒí¬ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-3] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.lit</span><br><span class="line"></span><br><span class="line">df.select(expr(<span class="string">&quot;*&quot;</span>), lit(<span class="number">1</span>).as(<span class="string">&quot;One&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|One|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---+</span></span><br><span class="line"><span class="comment">// |    United States|            Romania|   15|  1|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|  1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---+</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL ì—ì„œ ë¦¬í„°ëŸ´ì€ ìƒìˆ«ê°’ (ë™ì¼ í‘œí˜„)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, <span class="number">1</span> <span class="keyword">as</span> <span class="keyword">One</span> <span class="keyword">FROM</span> dfTable LIMIT <span class="number">2</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><strong>ë¦¬í„°ëŸ´(literal)</strong> : í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì˜ ë¦¬í„°ëŸ´ ê°’ =&gt; ìŠ¤íŒŒí¬ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ê°’ìœ¼ë¡œ ë³€í™˜<ul>
<li>ë•Œë¡œëŠ” ëª…ì‹œì  ê°’ (ìƒìˆ˜ê°’, ë¹„êµì— ì‚¬ìš©í•  ë¬´ì–¸ê°€ ë“±..) ì„ ìŠ¤íŒŒí¬ì— ì „ë‹¬í•´ì•¼í•¨ =&gt; ë¦¬í„°ëŸ´ ì‚¬ìš©</li>
<li>ë¦¬í„°ëŸ´ì€ í‘œí˜„ì‹</li>
<li>ì–´ë–¤ ìƒìˆ˜ë‚˜ í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ìƒì„±ëœ ë³€ìˆ«ê°’ì„ íŠ¹ì • ì»¬ëŸ¼ì˜ ê°’ê³¼ ë¹„êµí•  ë•Œ ì‚¬ìš©</li>
</ul>
</li>
</ul>
<h4 id="4-ì»¬ëŸ¼-ì¶”ê°€í•˜ê¸°"><a href="#4-ì»¬ëŸ¼-ì¶”ê°€í•˜ê¸°" class="headerlink" title="(4) ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°"></a>(4) ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-4] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">df.withColumn(<span class="string">&quot;numberOne&quot;</span>, lit(<span class="number">1</span>)).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|numberOne|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---------+</span></span><br><span class="line"><span class="comment">// |    United States|            Romania|   15|        1|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|        1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+---------+</span></span><br><span class="line"></span><br><span class="line">(df.withColumn(<span class="string">&quot;withinCountry&quot;</span>, expr(<span class="string">&quot;ORIGIN_COUNTRY_NAME == DEST_COUNTRY_NAME&quot;</span>))</span><br><span class="line">  .show(<span class="number">2</span>))</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|withinCountry|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"><span class="comment">// |    United States|            Romania|   15|        false|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|        false|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+-------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ì»¬ëŸ¼ëª… ë³€ê²½ë„ ê°€ëŠ¥ (DEST_COUNTRY_NAME -&gt; Destination)</span></span><br><span class="line">df.withColumn(<span class="string">&quot;Destination&quot;</span>, expr(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).columns</span><br><span class="line"><span class="comment">// res18: Array[String] = Array(DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count, Destination)</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>withColumn(ì»¬ëŸ¼ëª…, ê°’ì„ ìƒì„±í•  í‘œí˜„ì‹)</code> ì‚¬ìš©<ul>
<li>ê³µì‹ì  ì»¬ëŸ¼ ì¶”ê°€ ë°©ë²•</li>
<li>ì»¬ëŸ¼ëª… ë³€ê²½í•˜ì—¬ ì¶”ê°€ë„ ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<h4 id="5-ì»¬ëŸ¼ëª…-ë³€ê²½í•˜ê¸°"><a href="#5-ì»¬ëŸ¼ëª…-ë³€ê²½í•˜ê¸°" class="headerlink" title="(5) ì»¬ëŸ¼ëª… ë³€ê²½í•˜ê¸°"></a>(5) ì»¬ëŸ¼ëª… ë³€ê²½í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-5] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DEST_COUNTRY_NAME -&gt; dest ë¡œ ë³€ê²½</span></span><br><span class="line">df.withColumnRenamed(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>, <span class="string">&quot;dest&quot;</span>).columns</span><br><span class="line"><span class="comment">// res21: Array[String] = Array(dest, ORIGIN_COUNTRY_NAME, count)</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>withColumnRenamed(ì»¬ëŸ¼ëª…, ë³€ê²½í•  ë¬¸ìì—´)</code> ì‚¬ìš©</li>
</ul>
<h4 id="6-ì˜ˆì•½-ë¬¸ìì™€-í‚¤ì›Œë“œ"><a href="#6-ì˜ˆì•½-ë¬¸ìì™€-í‚¤ì›Œë“œ" class="headerlink" title="(6) ì˜ˆì•½ ë¬¸ìì™€ í‚¤ì›Œë“œ"></a>(6) ì˜ˆì•½ ë¬¸ìì™€ í‚¤ì›Œë“œ</h4><details><summary class="point-color-can-hover">[5.4-6] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ì´ìŠ¤ì¼€ì´í•‘ í•„ìš” ì—†ëŠ” ì˜ˆì‹œ - ìƒˆë¡œìš´ ì»¬ëŸ¼ëª…ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.expr</span><br><span class="line"><span class="keyword">val</span> dfWithLongColName = df.withColumn(</span><br><span class="line">  <span class="string">&quot;This Long Column-Name&quot;</span>,</span><br><span class="line">  expr(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>))</span><br><span class="line"><span class="comment">// dfWithLongColName: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 2 more fields]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ì´ìŠ¤ì¼€ì´í•‘ í•„ìš”í•œ ì˜ˆì‹œ - í‘œí˜„ì‹ìœ¼ë¡œ í•´ë‹¹ ì»¬ëŸ¼ì„ ì°¸ì¡° </span></span><br><span class="line">(dfWithLongColName.selectExpr(</span><br><span class="line">    <span class="string">&quot;`This Long Column-Name`&quot;</span>,</span><br><span class="line">    <span class="string">&quot;`This Long Column-Name` as `new col`&quot;</span>)</span><br><span class="line">  .show(<span class="number">2</span>))</span><br><span class="line"><span class="comment">// +---------------------+-------+</span></span><br><span class="line"><span class="comment">// |This Long Column-Name|new col|</span></span><br><span class="line"><span class="comment">// +---------------------+-------+</span></span><br><span class="line"><span class="comment">// |              Romania|Romania|</span></span><br><span class="line"><span class="comment">// |              Croatia|Croatia|</span></span><br><span class="line"><span class="comment">// +---------------------+-------+</span></span><br><span class="line"></span><br><span class="line">dfWithLongColName.createOrReplaceTempView(<span class="string">&quot;dfTableLong&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ê°™ì€ DataFrame ìƒì„±</span></span><br><span class="line">dfWithLongColName.select(col(<span class="string">&quot;This Long Column-Name&quot;</span>)).columns</span><br><span class="line">dfWithLongColName.select(expr(<span class="string">&quot;`This Long Column-Name`&quot;</span>)).columns</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL (ë™ì¼ í‘œí˜„)</span></span><br><span class="line"><span class="keyword">SELECT</span> `This Long <span class="keyword">Column</span><span class="operator">-</span>Name`, `This Long <span class="keyword">Column</span><span class="operator">-</span>Name` <span class="keyword">as</span> `<span class="keyword">new</span> col`</span><br><span class="line"><span class="keyword">FROM</span> dfTableLong LIMIT <span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>ì˜ˆì•½ ë¬¸ì(ê³µë°±, í•˜ì´í”ˆ (-) ë“±..) ëŠ” ì»¬ëŸ¼ëª… ì‚¬ìš© ë¶ˆê°€<ul>
<li>=&gt; ì‚¬ìš©í•˜ë ¤ë©´ <strong><code>`</code> (ë°±í‹±ë¬¸ì)</strong> ë¥¼ ì´ìš©í•œ ì´ìŠ¤ì¼€ì´í•‘(escaping) í•„ìš”</li>
</ul>
</li>
<li>ì˜ˆì•½ ë¬¸ìë‚˜ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” â€˜í‘œí˜„ì‹â€™ì—ëŠ” ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ í•„ìš”<ul>
<li>â€˜ë¬¸ìì—´â€™ë¡œ ëª…ì‹œì  ì»¬ëŸ¼ ì°¸ì¡° ì‹œì—ëŠ” ë¦¬í„°ëŸ´ë¡œ í•´ì„ =&gt; ì˜ˆì•½ë¬¸ì ì—†ì´ë„ ì°¸ì¡° ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<h4 id="7-ëŒ€ì†Œë¬¸ì-êµ¬ë¶„"><a href="#7-ëŒ€ì†Œë¬¸ì-êµ¬ë¶„" class="headerlink" title="(7) ëŒ€ì†Œë¬¸ì êµ¬ë¶„"></a>(7) ëŒ€ì†Œë¬¸ì êµ¬ë¶„</h4><details><summary class="point-color-can-hover">[5.4-7] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> spark.sql.caseSensitive <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>ê¸°ë³¸ì ìœ¼ë¡œ ìŠ¤íŒŒí¬ëŠ” ëŒ€ì†Œë¬¸ìë¥¼ ê°€ë¦¬ì§€ ì•ŠìŒ</li>
<li><code>set spark.sql.caseSenstive true</code> ì„¤ì • ì‹œ êµ¬ë¶„ ê°€ëŠ¥</li>
</ul>
<h4 id="8-ì»¬ëŸ¼-ì œê±°í•˜ê¸°"><a href="#8-ì»¬ëŸ¼-ì œê±°í•˜ê¸°" class="headerlink" title="(8) ì»¬ëŸ¼ ì œê±°í•˜ê¸°"></a>(8) ì»¬ëŸ¼ ì œê±°í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-8] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>).columns</span><br><span class="line"><span class="comment">// res30: Array[String] = Array(DEST_COUNTRY_NAME, count)</span></span><br><span class="line"></span><br><span class="line">dfWithLongColName.drop(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>, <span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)</span><br><span class="line"><span class="comment">// res32: org.apache.spark.sql.DataFrame = [count: bigint, This Long Column-Name: string]</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>drop(ì»¬ëŸ¼ëª…...)</code> ì‚¬ìš©<ul>
<li>ì—¬ëŸ¬ê°œë¥¼ ì¸ìˆ˜ë¡œ ë„£ì–´ ë‹¤ìˆ˜ì˜ ì»¬ëŸ¼ì„ í•œë²ˆì— ì œê±° ê°€ëŠ¥</li>
</ul>
</li>
<li><code>select()</code> ë¡œë„ ì œê±° ê°€ëŠ¥</li>
</ul>
<h4 id="9-ì»¬ëŸ¼ì˜-ë°ì´í„°-íƒ€ì…-ë³€ê²½í•˜ê¸°"><a href="#9-ì»¬ëŸ¼ì˜-ë°ì´í„°-íƒ€ì…-ë³€ê²½í•˜ê¸°" class="headerlink" title="(9) ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°"></a>(9) ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë³€ê²½í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-9] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// count ì»¬ëŸ¼ : Integer -&gt; String ìœ¼ë¡œ í˜•ë³€í™˜</span></span><br><span class="line">df.withColumn(<span class="string">&quot;count2&quot;</span>, col(<span class="string">&quot;count&quot;</span>).cast(<span class="string">&quot;long&quot;</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL (ë™ì¼ í‘œí˜„)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, <span class="built_in">cast</span>(count <span class="keyword">as</span> string) <span class="keyword">AS</span> count2 <span class="keyword">FROM</span> dfTable</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>cast()</code> ì‚¬ìš©<ul>
<li>íŠ¹ì • ë°ì´í„° íƒ€ì… =&gt; ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ í˜•ë³€í™˜</li>
</ul>
</li>
</ul>
<h4 id="10-ë¡œìš°-í•„í„°ë§í•˜ê¸°"><a href="#10-ë¡œìš°-í•„í„°ë§í•˜ê¸°" class="headerlink" title="(10) ë¡œìš° í•„í„°ë§í•˜ê¸°"></a>(10) ë¡œìš° í•„í„°ë§í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-10] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë™ì¼í•œ í‘œí˜„ì‹</span></span><br><span class="line">df.filter(col(<span class="string">&quot;count&quot;</span>) &lt; <span class="number">2</span>).show(<span class="number">2</span>)</span><br><span class="line">df.where(<span class="string">&quot;count &lt; 2&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|</span></span><br><span class="line"><span class="comment">// |    United States|          Singapore|    1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ì—¬ëŸ¬ í•„í„° ì ìš© ì‹œ (ìˆœì„œ ë¬´ê´€, ë™ì‹œ ì ìš©)</span></span><br><span class="line">df.where(col(<span class="string">&quot;count&quot;</span>) &lt; <span class="number">2</span>).where(col(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>) =!= <span class="string">&quot;Croatia&quot;</span>).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |    United States|          Singapore|    1|</span></span><br><span class="line"><span class="comment">// |          Moldova|      United States|    1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL (ë™ì¼ í‘œí˜„)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dfTable <span class="keyword">WHERE</span> count <span class="operator">&lt;</span> <span class="number">2</span> LIMIT <span class="number">2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dfTable <span class="keyword">WHERE</span> count <span class="operator">&lt;</span> <span class="number">2</span> <span class="keyword">AND</span> ORIGIN_COUNTRY_NAME <span class="operator">!=</span> &quot;Croatia&quot; LIMIT <span class="number">2</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>í•„í„°ë§ì„ í•˜ë ¤ë©´ ì°¸/ê±°ì§“ íŒë³„ í‘œí˜„ì‹ í•„ìš”<ul>
<li>ë¬¸ìì—´ í‘œí˜„ì‹, ì»¬ëŸ¼ì„ ë‹¤ë£¨ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ í‘œí˜„ì‹ ë§Œë“¦</li>
</ul>
</li>
<li><code>where()</code> <code>filter()</code> ì‚¬ìš© ê°€ëŠ¥<ul>
<li>ë‘ ë©”ì„œë“œ ëª¨ë‘ ê°™ì€ íŒŒë¼ë¯¸í„° íƒ€ì… ë° ê°™ì€ ì—°ì‚° ìˆ˜í–‰</li>
<li><code>where()</code> ëŠ” SQLê³¼ ìœ ì‚¬</li>
<li><code>filter()</code> ëŠ” Dataset APIë¥¼ ì´ìš©í•´ì„œ ì‚¬ìš©í•˜ë©´ Dataset ê° ë ˆì½”ë“œì— ì ìš© í•  í•¨ìˆ˜ë¥¼ ì‚¬ìš© ê°€ëŠ¥ (=&gt; ìì„¸í•œê±´ 11ì¥)</li>
</ul>
</li>
<li>ìŠ¤íŒŒí¬ëŠ” í•„í„°ì˜ ìˆœì„œì™€ ìƒê´€ì—†ì´ ë™ì‹œì— ëª¨ë“  í•„í„°ë§ ì‘ì—… ìˆ˜í–‰<ul>
<li>ê°™ì€ í‘œí˜„ì‹ì— ì—¬ëŸ¬ í•„í„° ì ìš©ì‹œ</li>
<li>ì°¨ë¡€ëŒ€ë¡œ AND í•„í„° ì—°ê²° í›„ íŒë‹¨ì€ ìŠ¤íŒŒí¬ì—ê²Œ ë§¡ê²¨ì•¼ í•¨</li>
</ul>
</li>
</ul>
<h4 id="11-ê³ ìœ í•œ-ë¡œìš°-ì–»ê¸°"><a href="#11-ê³ ìœ í•œ-ë¡œìš°-ì–»ê¸°" class="headerlink" title="(11) ê³ ìœ í•œ ë¡œìš° ì–»ê¸°"></a>(11) ê³ ìœ í•œ ë¡œìš° ì–»ê¸°</h4><details><summary class="point-color-can-hover">[5.4-11] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.select(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>, <span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).distinct().count()</span><br><span class="line"><span class="comment">// res41: Long = 256</span></span><br><span class="line"></span><br><span class="line">df.select(<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>).distinct().count()</span><br><span class="line"><span class="comment">// res44: Long = 125</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL (ë™ì¼ í‘œí˜„)</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span>(ORIGIN_COUNTRY_NAME, DEST_COUNTRY_NAME)) <span class="keyword">FROM</span> dfTable</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ORIGIN_COUNTRY_NAME) <span class="keyword">FROM</span> dfTable</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>distinct()</code> ì‚¬ìš©<ul>
<li>ê³ ìœ³ê°’ì´ë‚˜ ì¤‘ë³µë˜ì§€ ì•Šì€ ê°’ì„ ì–»ëŠ” ì—°ì‚°</li>
</ul>
</li>
</ul>
<h4 id="12-ë¬´ì‘ìœ„-ìƒ˜í”Œ-ë§Œë“¤ê¸°"><a href="#12-ë¬´ì‘ìœ„-ìƒ˜í”Œ-ë§Œë“¤ê¸°" class="headerlink" title="(12) ë¬´ì‘ìœ„ ìƒ˜í”Œ ë§Œë“¤ê¸°"></a>(12) ë¬´ì‘ìœ„ ìƒ˜í”Œ ë§Œë“¤ê¸°</h4><details><summary class="point-color-can-hover">[5.4-12] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> seed = <span class="number">5</span></span><br><span class="line"><span class="keyword">val</span> withReplacement = <span class="literal">false</span></span><br><span class="line"><span class="keyword">val</span> fraction = <span class="number">0.5</span></span><br><span class="line">df.sample(withReplacement, fraction, seed).count()</span><br><span class="line"><span class="comment">// res46: Long = 126</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>sample(ë³µì›ì¶”ì¶œ ì—¬ë¶€, ì¶”ì¶œ ë¹„ìœ¨, seed)</code> ì‚¬ìš©<ul>
<li>í‘œë³¸ ë°ì´í„° ì¶”ì¶œ ë¹„ìœ¨ (&lt;=1.0) ì§€ì • ê°€ëŠ¥</li>
<li>ë³µì› ì¶”ì¶œ (sample with replacement), ë¹„ë³µì› ì¶”ì¶œ (sample without replacement) ì‚¬ìš© ì—¬ë¶€ ì§€ì • ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<h4 id="13-ì„ì˜-ë¶„í• í•˜ê¸°"><a href="#13-ì„ì˜-ë¶„í• í•˜ê¸°" class="headerlink" title="(13) ì„ì˜ ë¶„í• í•˜ê¸°"></a>(13) ì„ì˜ ë¶„í• í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-13] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ì´í•©ì´ 1ì´ ì•„ë‹ ê²½ìš° ì„¤ì •ë˜ëŠ” default</span></span><br><span class="line"><span class="keyword">val</span> dataFrames = df.randomSplit(<span class="type">Array</span>(<span class="number">0.25</span>, <span class="number">0.75</span>), seed)</span><br><span class="line">dataFrames(<span class="number">0</span>).count() &gt; dataFrames(<span class="number">1</span>).count()</span><br><span class="line"><span class="comment">// res51: Boolean = false</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>ì„ì˜ ë¶„í•  (random split) : ì›ë³¸ DataFrame ì„ ì„ì˜ í¬ê¸°ë¡œ â€˜ë¶„í• â€™<ul>
<li>ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš© ì‹œ í•™ìŠµì…‹, ê²€ì¦ì…‹, í…ŒìŠ¤íŠ¸ì…‹ ë§Œë“¤ë•Œ ì£¼ë¡œ ì‚¬ìš©</li>
</ul>
</li>
<li><code>randomSplit(ë¶„í•  ê°€ì¤‘ì¹˜ Array, seed)</code><ul>
<li>ì„ì˜ì„±(randomized) ì„ ê°€ì§€ë¯€ë¡œ ì‹œë“œê°’(seed) í•„ìˆ˜</li>
<li>DataFrame ë¹„ìœ¨ì€ ì´í•©ì´ 1ì´ ë˜ê²Œ ì§€ì • (ì•„ë‹ ê²½ìš° ì˜ˆì œ ë¹„ìœ¨ë¡œ ì§€ì •ë¨)</li>
</ul>
</li>
</ul>
<h4 id="14-ë¡œìš°-í•©ì¹˜ê¸°ì™€-ì¶”ê°€í•˜ê¸°"><a href="#14-ë¡œìš°-í•©ì¹˜ê¸°ì™€-ì¶”ê°€í•˜ê¸°" class="headerlink" title="(14) ë¡œìš° í•©ì¹˜ê¸°ì™€ ì¶”ê°€í•˜ê¸°"></a>(14) ë¡œìš° í•©ì¹˜ê¸°ì™€ ì¶”ê°€í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-14] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"><span class="keyword">val</span> schema = df.schema</span><br><span class="line"><span class="keyword">val</span> newRows = <span class="type">Seq</span>(</span><br><span class="line">  <span class="type">Row</span>(<span class="string">&quot;New Country&quot;</span>, <span class="string">&quot;Other Country&quot;</span>, <span class="number">5</span>L),</span><br><span class="line">  <span class="type">Row</span>(<span class="string">&quot;New Country 2&quot;</span>, <span class="string">&quot;Other Country 3&quot;</span>, <span class="number">1</span>L)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">val</span> parallelizedRows = spark.sparkContext.parallelize(newRows)</span><br><span class="line"><span class="keyword">val</span> newDF = spark.createDataFrame(parallelizedRows, schema)</span><br><span class="line"></span><br><span class="line"><span class="comment">// df + newDF =&gt; ë¡œìš°ê°€ ì¶”ê°€ëœ ìƒˆë¡œìš´ ê°ì²´</span></span><br><span class="line">(df.union(newDF)</span><br><span class="line">  .where(<span class="string">&quot;count = 1&quot;</span>)</span><br><span class="line">  .where($<span class="string">&quot;ORIGIN_COUNTRY_NAME&quot;</span> =!= <span class="string">&quot;United States&quot;</span>)</span><br><span class="line">  .show()) <span class="comment">// get all of them and we&#x27;ll see our new rows at the end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// schema: org.apache.spark.sql.types.StructType = StructType(StructField(DEST_COUNTRY_NAME,StringType,true), StructField(ORIGIN_COUNTRY_NAME,StringType,true), StructField(count,LongType,true))</span></span><br><span class="line"><span class="comment">// newRows: Seq[org.apache.spark.sql.Row] = List([New Country,Other Country,5], [New Country 2,Other Country 3,1])</span></span><br><span class="line"><span class="comment">// parallelizedRows: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = ParallelCollectionRDD[74] at parallelize at &lt;console&gt;:29</span></span><br><span class="line"><span class="comment">// newDF: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|</span></span><br><span class="line"><span class="comment">// |    United States|          Singapore|    1|</span></span><br><span class="line"><span class="comment">// |    United States|          Gibraltar|    1|</span></span><br><span class="line"><span class="comment">// |    United States|             Cyprus|    1|</span></span><br><span class="line"><span class="comment">// |    United States|            Estonia|    1|</span></span><br><span class="line"><span class="comment">// |    United States|          Lithuania|    1|</span></span><br><span class="line"><span class="comment">// |    United States|           Bulgaria|    1|</span></span><br><span class="line"><span class="comment">// |    United States|            Georgia|    1|</span></span><br><span class="line"><span class="comment">// |    United States|            Bahrain|    1|</span></span><br><span class="line"><span class="comment">// |    United States|   Papua New Guinea|    1|</span></span><br><span class="line"><span class="comment">// |    United States|         Montenegro|    1|</span></span><br><span class="line"><span class="comment">// |    United States|            Namibia|    1|</span></span><br><span class="line"><span class="comment">// |    New Country 2|    Other Country 3|    1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>DataFrameì€ ë¶ˆë³€ì„± (immutability)<ul>
<li>DataFrameì„ ë³€ê²½í•˜ëŠ” ë ˆì½”ë“œ ì¶”ê°€ëŠ” ë¶ˆê°€ëŠ¥</li>
<li>=&gt; ì›ë³¸ DataFrameì„ ìƒˆë¡œìš´ DataFrameê³¼ <strong>í†µí•©(union)</strong> (ê²°í•©)</li>
<li>ë‹¨, í†µí•©í•˜ë ¤ëŠ” ë‘ DataFrameì€ ë°˜ë“œì‹œ ë™ì¼í•œ ìŠ¤í‚¤ë§ˆì™€ ì»¬ëŸ¼ ìˆ˜ë¥¼ ê°€ì ¸ì•¼ í•¨</li>
</ul>
</li>
<li><code>union()</code><ul>
<li>í˜„ì¬ ìŠ¤í‚¤ë§ˆê°€ ì•„ë‹Œ ì»¬ëŸ¼ ìœ„ì¹˜ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘ (ìë™ ì •ë ¬ X)</li>
<li>ë¡œìš°ê°€ ì¶”ê°€ëœ DataFrame ì„ ì°¸ì¡°í•˜ë ¤ë©´ ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì§„ DataFrame ì‚¬ìš©í•´ì•¼í•˜ì§€ë§Œ, <u>ë·°ë‚˜ í…Œì´ë¸”ë¡œ ë“±ë¡ ì‹œì—ëŠ” ë™ì ìœ¼ë¡œ ì°¸ì¡° ê°€ëŠ¥</u></li>
</ul>
</li>
<li>ì»¬ëŸ¼ í‘œí˜„ì‹ê³¼ ë¬¸ì ë¹„êµì—´ ë¹„êµ ì‹œ<ul>
<li>(ì»¬ëŸ¼ í‘œí˜„ì‹ì´ ì•„ë‹Œ) ì»¬ëŸ¼ì˜ ì‹¤ì œê°’ì„ ë¹„êµ ëŒ€ìƒ ë¬¸ìì—´ê³¼ ë¹„êµí•˜ë ¤ë©´</li>
<li>ìŠ¤ì¹¼ë¼ ì‚¬ìš© ì‹œ ë°˜ë“œì‹œ <strong><code>=!=</code> í•¨ìˆ˜</strong> ì‚¬ìš©<ul>
<li><code>=!=</code>, <code>===</code> ëŠ” ìŠ¤íŒŒí¬ì˜ Column í´ë˜ìŠ¤ì— ì •ì˜ëœ í•¨ìˆ˜</li>
</ul>
</li>
<li>íŒŒì´ì¬ì€ ê·¸ëŒ€ë¡œ <code>!=</code>, <code>==</code></li>
</ul>
</li>
</ul>
<h4 id="15-ë¡œìš°-ì •ë ¬í•˜ê¸°"><a href="#15-ë¡œìš°-ì •ë ¬í•˜ê¸°" class="headerlink" title="(15) ë¡œìš° ì •ë ¬í•˜ê¸°"></a>(15) ë¡œìš° ì •ë ¬í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-15] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">df.sort(<span class="string">&quot;count&quot;</span>).show(<span class="number">5</span>)</span><br><span class="line">df.orderBy(<span class="string">&quot;count&quot;</span>, <span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="number">5</span>)</span><br><span class="line">df.orderBy(col(<span class="string">&quot;count&quot;</span>), col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ì •ë ¬ ê¸°ì¤€ ì§€ì • (desc ì˜¤ë¦„)</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.&#123;desc, asc&#125;</span><br><span class="line"></span><br><span class="line">df.orderBy(expr(<span class="string">&quot;count desc&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// ì´ê±° ì™œ ë‚´ë¦¼ì°¨ìˆœì´ì•„ë‹ˆë¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ë‚˜ì˜¤ë‚˜... expr(&quot;count desc&quot;) ì„¤ì • ì•ˆë˜ê³  default ì •ë ¬ (asc)ë¡œ ì„¤ì •ë˜ì„œ ë‚˜ì˜¤ëŠ” ë“¯í•œë°..?</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |          Moldova|      United States|    1|</span></span><br><span class="line"><span class="comment">// |    United States|            Croatia|    1|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+-----+</span></span><br><span class="line"></span><br><span class="line">df.orderBy(desc(<span class="string">&quot;count&quot;</span>), asc(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME| count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br><span class="line"><span class="comment">// |    United States|      United States|370002|</span></span><br><span class="line"><span class="comment">// |    United States|             Canada|  8483|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dfTable <span class="keyword">ORDER</span> <span class="keyword">BY</span> count <span class="keyword">DESC</span>, DEST_COUNTRY_NAME <span class="keyword">ASC</span> LIMIT <span class="number">2</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sortWithinPartitions() ë¡œ íŒŒí‹°ì…˜ë³„ ì •ë ¬</span></span><br><span class="line">(spark.read.format(<span class="string">&quot;json&quot;</span>).load(<span class="string">&quot;/data/flight-data/json/*-summary.json&quot;</span>)</span><br><span class="line">  .sortWithinPartitions(<span class="string">&quot;count&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// explain() ì‹œ</span></span><br><span class="line"><span class="comment">// == Physical Plan ==</span></span><br><span class="line"><span class="comment">// *(1) Sort [count#450L ASC NULLS FIRST], false, 0</span></span><br><span class="line"><span class="comment">// +- *(1) FileScan json [DEST_COUNTRY_NAME#448,ORIGIN_COUNTRY_NAME#449,count#450L] Batched: false, Format: JSON, Location: InMemoryFileIndex[file:/data/flight-data/json/2015-summary.json, file:/data/flight-data/json/2012..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:bigint&gt;</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>sort()</code> <code>orderBy()</code> ì‚¬ìš©<ul>
<li>ë‘ ë©”ì„œë“œëŠ” ì™„ì „íˆ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë™ì‘ (<code>orderBy()</code> ë‚´ë¶€ì—ì„œ <code>sort()</code> ì‚¬ìš©)</li>
<li>ë‹¤ìˆ˜ ì»¬ëŸ¼ ì§€ì •, ì»¬ëŸ¼ í‘œí˜„ì‹, ë¬¸ìì—´ ì‚¬ìš© ê°€ëŠ¥</li>
<li>ì •ë ¬ ê¸°ì¤€ : <code>asc()</code>, <code>desc()</code> ë¡œ ëª…í™•í•œ ì§€ì • ê°€ëŠ¥ (ê¸°ë³¸ ë™ì‘ì€ ì˜¤ë¦„ì°¨ìˆœ)</li>
</ul>
</li>
<li>ì •ë ¬ëœ DataFrame ì˜ NULL ê°’ í‘œì‹œ ê¸°ì¤€<ul>
<li><code>asc_nulls_first</code>, <code>desc_nulls_first</code>, <code>asc_nulls_last</code>, <code>desc_nulls_last</code> ë¡œ ê¸°ì¤€ ì§€ì • ê°€ëŠ¥</li>
</ul>
</li>
<li>íŒŒí‹°ì…˜ ë³„ ì •ë ¬ =&gt; <code>sortWithinPartitions()</code><ul>
<li>íŠ¸ëœìŠ¤í¬ë©”ì´ì…˜ ì²˜ë¦¬ ì „ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•¨</li>
<li>ë” ìì„¸í•œ íŠœë‹ê³¼ ìµœì í™” ë‚´ìš©ì€ 3ë¶€ì—ì„œ</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>df.orderBy(expr(&quot;count desc&quot;))</code> ?</p>
<ul>
<li>count ì»¬ëŸ¼ì„ desc() (ë‚´ë¦¼ì°¨ìˆœ) ìœ¼ë¡œ ì •ë ¬ë˜ì•¼ ë§ë‚˜?<ul>
<li>ì‹¤ì œë¡œëŠ” ê·¸ë ‡ê²Œ ë™ì‘ í•˜ì§€ ì•ŠìŒ (=&gt; ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ë¨)</li>
</ul>
</li>
<li>ì˜ëª»ëœ ì˜ˆì œì¸ë“¯í•œë°..<ul>
<li>ê´€ë ¨ stackoverflow ì§ˆë¬¸ <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/63112281/pyspark-sort-dataframe-by-expression">ë§í¬ 1</a> / <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/63373479/sorting-2-columns-in-opposite-direction-does-not-work-using-expr-function">ë§í¬ 2</a></li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="16-ë¡œìš°-ìˆ˜-ì œí•œí•˜ê¸°"><a href="#16-ë¡œìš°-ìˆ˜-ì œí•œí•˜ê¸°" class="headerlink" title="(16) ë¡œìš° ìˆ˜ ì œí•œí•˜ê¸°"></a>(16) ë¡œìš° ìˆ˜ ì œí•œí•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-16] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">df.limit(<span class="number">5</span>).show()</span><br><span class="line"></span><br><span class="line">df.orderBy(expr(<span class="string">&quot;count desc&quot;</span>)).limit(<span class="number">6</span>).show()</span><br><span class="line"><span class="comment">// +--------------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |   DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|</span></span><br><span class="line"><span class="comment">// +--------------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">// |               Malta|      United States|    1|</span></span><br><span class="line"><span class="comment">// |Saint Vincent and...|      United States|    1|</span></span><br><span class="line"><span class="comment">// |       United States|            Croatia|    1|</span></span><br><span class="line"><span class="comment">// |       United States|          Gibraltar|    1|</span></span><br><span class="line"><span class="comment">// |       United States|          Singapore|    1|</span></span><br><span class="line"><span class="comment">// |             Moldova|      United States|    1|</span></span><br><span class="line"><span class="comment">// +--------------------+-------------------+-----+</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// ë’·êµ¬ë¥´ê¸°í•˜ë©´ì„œ ë´ë„ ê²°ê³¼ê°€ ì´ë ‡ê²Œ ë‚˜ì™€ì•¼í• ê±°ê°™ì€ë°...</span></span><br><span class="line"><span class="comment">// df.orderBy(desc(&quot;count&quot;)).limit(6).show()</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br><span class="line"><span class="comment">// |DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME| count|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br><span class="line"><span class="comment">// |    United States|      United States|370002|</span></span><br><span class="line"><span class="comment">// |    United States|             Canada|  8483|</span></span><br><span class="line"><span class="comment">// |           Canada|      United States|  8399|</span></span><br><span class="line"><span class="comment">// |    United States|             Mexico|  7187|</span></span><br><span class="line"><span class="comment">// |           Mexico|      United States|  7140|</span></span><br><span class="line"><span class="comment">// |   United Kingdom|      United States|  2025|</span></span><br><span class="line"><span class="comment">// +-----------------+-------------------+------+</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dfTable LIMIT <span class="number">6</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li><code>limit(ë¡œìš° ìˆ˜)</code> ì‚¬ìš©<ul>
<li>ì¶”ì¶œí•  ë¡œìš° ìˆ˜ ì œí•œí•˜ì—¬ ì¶”ì¶œ</li>
</ul>
</li>
</ul>
<h4 id="17-repartitionê³¼-coalesce"><a href="#17-repartitionê³¼-coalesce" class="headerlink" title="(17) repartitionê³¼ coalesce"></a>(17) repartitionê³¼ coalesce</h4><details><summary class="point-color-can-hover">[5.4-17] ì˜ˆì œ í¼ì¹˜ê¸° </summary>

<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataFrame í˜„ì¬ íŒŒí‹°ì…˜ ìˆ˜ êµ¬í•˜ê¸°</span></span><br><span class="line">df.rdd.getNumPartitions <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ì „ì²´ ë°ì´í„° ì…”í”Œ</span></span><br><span class="line">df.repartition(<span class="number">5</span>)</span><br><span class="line"><span class="comment">// df.repartition(5).rdd.getNumPartitions =&gt; 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// íŠ¹ì • ì»¬ëŸ¼ ê¸°ì¤€ íŒŒí‹°ì…˜ ì¬ë¶„ë°°</span></span><br><span class="line">df.repartition(col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>))</span><br><span class="line"><span class="comment">// df.repartition(col(&quot;DEST_COUNTRY_NAME&quot;)).rdd.getNumPartition =&gt; 200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// íŠ¹ì • ì»¬ëŸ¼ ì§€ì • + íŒŒí‹°ì…˜ ìˆ˜ ì§€ì •</span></span><br><span class="line">df.repartition(<span class="number">5</span>, col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>))</span><br><span class="line"><span class="comment">// df.repartition(5, col(&quot;DEST_COUNTRY_NAME&quot;)).rdd.getNumPartitions =&gt; 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// coalesce() ë¡œ ì…”í”Œì—†ì´ íŒŒí‹°ì…˜ ë³‘í•© (1 -&gt; 5 -&gt; 2)</span></span><br><span class="line">df.repartition(<span class="number">5</span>, col(<span class="string">&quot;DEST_COUNTRY_NAME&quot;</span>)).coalesce(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// df.repartition(5, col(&quot;DEST_COUNTRY_NAME&quot;)).coalesce(2).rdd.getNumPartitions =&gt; 2</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>ë˜ ë‹¤ë¥¸ ìµœì í™” ê¸°ë²•? =&gt; ìì£¼ í•„í„°ë§í•˜ëŠ” ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° ë¶„í• <ul>
<li>íŒŒí‹°ì…”ë‹ ìŠ¤í‚¤ë§ˆì™€ íŒŒí‹°ì…˜ ìˆ˜ë¥¼ í¬í•¨í•œ í´ëŸ¬ìŠ¤í„° ì „ë°˜ì˜ ë¬¼ë¦¬ì  ë°ì´í„° êµ¬ì„± ì œì–´ ê°€ëŠ¥</li>
</ul>
</li>
<li><code>repartition()</code> : ì „ì²´ ë°ì´í„° ì…”í”Œ<ul>
<li>í–¥í›„ ì‚¬ìš©í•  íŒŒí‹°ì…˜ ìˆ˜ &gt; í˜„ì¬ íŒŒí‹°ì…˜ ìˆ˜ ì¸ ê²½ìš° ì‚¬ìš© (íŒŒí‹°ì…˜ ìˆ˜ â†‘)</li>
<li>ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ íŒŒí‹°ì…˜ì„ ë§Œë“œëŠ” ê²½ìš° ì‚¬ìš©<ul>
<li>ìì£¼ í•„í„°ë§ë˜ëŠ” ì»¬ëŸ¼ì´ ìˆë‹¤ë©´ í•´ë‹¹ ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ íŒŒí‹°ì…˜ ì¬ë¶„ë°° ì¶”ì²œ</li>
</ul>
</li>
<li>ì„ íƒì ìœ¼ë¡œ íŒŒí‹°ì…˜ ìˆ˜ ì§€ì • ê°€ëŠ¥</li>
</ul>
</li>
<li><code>coalesce()</code> : ì „ì²´ ë°ì´í„° ì…”í”Œ ì—†ì´ íŒŒí‹°ì…˜ ë³‘í•©<ul>
<li><strong>íŒŒí‹°ì…˜ ìˆ˜ë¥¼ ì¤„ì´ë ¤ë©´</strong> coalesce ì‚¬ìš© (<del>repartition</del> X)</li>
</ul>
</li>
<li>DataFrame íŒŒí‹°ì…˜ ìˆ˜ í™•ì¸ì€ <code>df.rdd.getNumPartitions</code> ë¡œ í™•ì¸</li>
</ul>
<h4 id="18-ë“œë¼ì´ë²„ë¡œ-ë¡œìš°-ë°ì´í„°-ìˆ˜ì§‘í•˜ê¸°"><a href="#18-ë“œë¼ì´ë²„ë¡œ-ë¡œìš°-ë°ì´í„°-ìˆ˜ì§‘í•˜ê¸°" class="headerlink" title="(18) ë“œë¼ì´ë²„ë¡œ ë¡œìš° ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°"></a>(18) ë“œë¼ì´ë²„ë¡œ ë¡œìš° ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°</h4><details><summary class="point-color-can-hover">[5.4-18] ì˜ˆì œ í¼ì¹˜ê¸° </summary>


</details>

<ul>
<li>ìŠ¤íŒŒí¬ëŠ” â€˜ë“œë¼ì´ë²„â€™ì—ì„œ í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì •ë³´ ìœ ì§€<ul>
<li>ë¡œì»¬ í™˜ê²½ì—ì„œ ë°ì´í„° ë‹¤ë£° ë•ŒëŠ” â€˜ë“œë¼ì´ë²„â€™ë¡œ ë°ì´í„° ìˆ˜ì§‘</li>
</ul>
</li>
<li>ì‚¬ìš©í•´ë³¸ ë°ì´í„° ìˆ˜ì§‘ ë©”ì„œë“œ ì¼ë¶€<ul>
<li><code>collect()</code> : ì „ì²´ DataFrameì˜ ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘</li>
<li><code>take()</code> : ìƒìœ„ Nê°œ ë¡œìš° ë°˜í™˜</li>
<li><code>show()</code> : ì—¬ëŸ¬ ë¡œìš°ë¥¼ ë³´ê¸° ì¢‹ê²Œ ì¶œë ¥</li>
</ul>
</li>
<li><code>toLocalIterator()</code> : ì „ì²´ ë°ì´í„°ì…‹ì— ëŒ€í•œ ë°˜ë³µ(iterate) ì²˜ë¦¬ë¥¼ ìœ„í•´ â€˜ë“œë¼ì´ë²„â€™ë¡œ ë¡œìš°ë¥¼ ëª¨ìœ¼ëŠ” ë°©ë²•<ul>
<li>iterator(ë°˜ë³µì) ë¡œ ëª¨ë“  íŒŒí‹°ì…˜ì˜ ë°ì´í„°ë¥¼ â€˜ë“œë¼ì´ë²„â€™ì— ì „ë‹¬</li>
<li>ë°ì´í„°ì…‹ì˜ íŒŒí‹°ì…˜ì„ ì°¨ë¡€ëŒ€ë¡œ ë°˜ë³µ ì²˜ë¦¬ ê°€ëŠ¥</li>
</ul>
</li>
<li>ë“œë¼ì´ë²„ë¡œ ëª¨ë“  ë°ì´í„° ì»¬ë ‰ì…˜ì„ ìˆ˜ì§‘í•˜ëŠ” ê±´<ul>
<li>=&gt; <strong>ë§¤ìš° í° ë¹„ìš©</strong> (CPU, ë©”ëª¨ë¦¬, ë„¤íŠ¸ì›Œí¬)</li>
<li>ì°¨ë¡€ëŒ€ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì²˜ë¦¬ ë¹„ìš© ì—„ì²­ë‚¨ (ë³‘ë ¬ ì—°ì‚° X)</li>
</ul>
</li>
<li>ë”°ë¼ì„œ ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì— <code>collect()</code> ë‚˜ ë§¤ìš° í° íŒŒí‹°ì…˜ì— ëŒ€í•´ <code>toLocalIterator()</code> ì‚¬ìš© ì‹œ =&gt; ë“œë¼ì´ë²„ ë¹„ì •ìƒì  ì¢…ë£Œ</li>
</ul>
<h3 id="5-5-ì •ë¦¬"><a href="#5-5-ì •ë¦¬" class="headerlink" title="5.5 ì •ë¦¬"></a>5.5 ì •ë¦¬</h3><ul>
<li>DataFrame ê¸°ë³¸ ì—°ì‚°</li>
<li>DataFrame ì‚¬ìš©ì— í•„ìš”í•œ ê°œë…, ë‹¤ì–‘í•œ ê¸°ëŠ¥</li>
</ul>
<h3 id="ğŸ“’-ë‹¨ì–´ì¥"><a href="#ğŸ“’-ë‹¨ì–´ì¥" class="headerlink" title="ğŸ“’ ë‹¨ì–´ì¥"></a>ğŸ“’ ë‹¨ì–´ì¥</h3><ul>
<li>ë¹„ê²°ì •ë¡ ì (nondeterministically) : = ë§¤ë²ˆ ë³€í•˜ëŠ”</li>
<li>ETL : <code>ì¶”ì¶œ(Extract)</code> - <code>ë³€í™˜(Transform)</code> - <code>ì ì¬(Load)</code>  <i style="color:lightgray">(ì¹œìˆ™í•˜ì¥¬?)</i></li>
</ul>
</div><p class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/study/">#study</a><a href="/tags/book/">#book</a><a href="/tags/spark/">#spark</a><a href="/tags/apache/">#apache</a></p></article></div><footer><div class="paginator"><a class="next" href="/2021/01/26/Spark-The-Definitive-Guide-4%EC%9E%A5/">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'minsw-github-io';
var disqus_identifier = '2021/01/26/Spark-The-Definitive-Guide-5ì¥/';
var disqus_title = '&amp;#039;Spark The Definitive Guide&amp;#039; 5ì¥ - êµ¬ì¡°ì  API ê¸°ë³¸ ì—°ì‚°';
var disqus_url = 'https://minsw.github.io/2021/01/26/Spark-The-Definitive-Guide-5ì¥/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>Â© 2018 - 2021 <a href="https://minsw.github.io">Lukka Min</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-143001954-1",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script></body></html>